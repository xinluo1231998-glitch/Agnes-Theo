<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>èƒ–æ¬£æ¬£ & ç˜¦åª›åª›çš„ä¸“å±æƒ…äººèŠ‚</title>
  <meta name="description" content="æç®€è«å…°è¿ªé£ï¼šç‚¹èœ + å¿ƒæ„¿ + ç¡®è®¤ä¸‹å•ï¼ˆæœ¬åœ°ä¿å­˜ + é«˜æ¸…å›¾ IndexedDB + Formspree é‚®ä»¶é€šçŸ¥ï¼‰" />
  <style>
    :root{
      /* Morandi palette */
      --bg: #F6F3EE;          /* å¥¶æ²¹ç™½ */
      --card: #FFFFFF;
      --ink: #1F2328;
      --muted: #6D7179;
      --line: rgba(31,35,40,.10);

      --pink: #C7A5A9;        /* è«å…°è¿ªç²‰ */
      --sage: #AEB9AD;        /* ç°ç»¿ */
      --slate: #8D97A1;       /* ç°è“ */
      --clay: #C8B3A4;        /* å¥¶èŒ¶ */

      --shadow: 0 14px 36px rgba(31,35,40,.08);
      --shadow2: 0 10px 22px rgba(31,35,40,.06);
      --radius: 22px;
      --radius2: 18px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif;
      color: var(--ink);
      background: var(--bg);
      letter-spacing: .1px;
    }

    .wrap{
      max-width: 1120px;
      margin: 0 auto;
      padding: 28px 16px 56px;
    }

    /* Header */
    .hero{
      background: rgba(255,255,255,.78);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 22px 22px 18px;
    }

    .heroTop{
      display:flex;
      justify-content: space-between;
      align-items:flex-start;
      gap: 14px;
      flex-wrap: wrap;
    }

    h1{
      margin: 0;
      font-size: clamp(22px, 2.5vw, 34px);
      font-weight: 900;
    }

    .sub{
      margin-top: 10px;
      color: var(--muted);
      line-height: 1.7;
      font-size: 14px;
      max-width: 860px;
    }

    .quoteRow{
      margin-top: 14px;
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .chip{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.75);
      border-radius: 999px;
      padding: 8px 12px;
      font-size: 12px;
      color: rgba(31,35,40,.78);
    }

    .heroActions{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: flex-end;
      margin-left: auto;
    }

    button{
      font: inherit;
      cursor: pointer;
    }

    .btn{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.85);
      padding: 10px 12px;
      border-radius: 14px;
      transition: transform .05s ease, background .15s ease, border-color .15s ease;
      display:inline-flex;
      align-items:center;
      gap: 8px;
      user-select:none;
    }
    .btn:hover{ background: #fff; border-color: rgba(31,35,40,.16); }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{
      background: rgba(199,165,169,.18);
      border-color: rgba(199,165,169,.35);
    }
    .btn.sage{
      background: rgba(174,185,173,.20);
      border-color: rgba(174,185,173,.40);
    }
    .btn.danger{
      background: rgba(255,255,255,.85);
      border-color: rgba(170,70,70,.25);
      color: rgba(140,40,40,.95);
    }

    .grid{
      margin-top: 18px;
      display:grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }
    @media(min-width: 980px){
      .grid{ grid-template-columns: 1.55fr 1fr; }
    }

    .panel{
      background: rgba(255,255,255,.80);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow2);
      overflow:hidden;
    }

    .panelHead{
      padding: 16px 16px 12px;
      border-bottom: 1px solid var(--line);
      display:flex;
      align-items:flex-start;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    .panelTitle{
      margin:0;
      font-size: 16px;
      font-weight: 900;
    }
    .panelDesc{
      margin: 6px 0 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.55;
    }

    .tabs{
      display:flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 10px;
    }
    .tab{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.75);
      border-radius: 999px;
      padding: 7px 10px;
      font-size: 12px;
      color: rgba(31,35,40,.78);
      cursor:pointer;
      user-select:none;
    }
    .tab.active{
      background: rgba(141,151,161,.14);
      border-color: rgba(141,151,161,.35);
      color: rgba(31,35,40,.88);
    }

    .searchRow{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 10px;
      align-items:center;
    }
    .field{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.92);
      padding: 10px 12px;
      border-radius: 14px;
      outline:none;
      min-width: 240px;
      flex: 1;
    }
    .field:focus{ border-color: rgba(141,151,161,.55); }

    .content{
      padding: 14px;
    }

    .cards{
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }
    @media(min-width: 640px){
      .cards{ grid-template-columns: 1fr 1fr; }
    }

    .card{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.92);
      border-radius: var(--radius2);
      overflow:hidden;
      display:flex;
      flex-direction: column;
      min-height: 290px;
    }

    .thumb{
      height: 150px;
      background: linear-gradient(135deg, rgba(199,165,169,.18), rgba(174,185,173,.16));
      position: relative;
      border-bottom: 1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .thumb img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
    }
    .thumb .thumbHint{
      position:absolute;
      inset:auto 10px 10px 10px;
      display:flex;
      justify-content: space-between;
      gap: 8px;
      pointer-events:none;
    }
    .pill{
      border: 1px solid rgba(31,35,40,.10);
      background: rgba(255,255,255,.72);
      border-radius: 999px;
      padding: 6px 9px;
      font-size: 12px;
      color: rgba(31,35,40,.78);
      backdrop-filter: blur(6px);
      max-width: 100%;
      overflow:hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .cardBody{
      padding: 12px 12px 14px;
      display:flex;
      flex-direction: column;
      gap: 10px;
      flex: 1;
    }

    .row{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    .name{
      margin:0;
      font-weight: 900;
      font-size: 15px;
    }

    .meta{
      display:flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items:center;
    }

    .badge{
      font-size: 12px;
      padding: 5px 9px;
      border-radius: 999px;
      border: 1px solid rgba(31,35,40,.10);
      background: rgba(255,255,255,.72);
      color: rgba(31,35,40,.74);
    }

    .price{
      font-size: 12px;
      padding: 5px 9px;
      border-radius: 999px;
      border: 1px solid rgba(31,35,40,.10);
      background: rgba(255,255,255,.72);
      color: rgba(31,35,40,.78);
    }

    .note{
      width:100%;
      min-height: 72px;
      resize: vertical;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.92);
      border-radius: 14px;
      padding: 10px 12px;
      outline:none;
      line-height: 1.55;
      color: rgba(31,35,40,.88);
    }
    .note:focus{ border-color: rgba(141,151,161,.55); }

    .btnRow{
      display:flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 2px;
    }

    .selectRow{
      display:flex;
      justify-content: space-between;
      align-items:center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .toggle{
      display:flex;
      align-items:center;
      gap: 8px;
      user-select:none;
      font-size: 13px;
      color: rgba(31,35,40,.82);
    }

    input[type="checkbox"]{
      width: 18px;
      height: 18px;
      accent-color: var(--pink);
    }

    /* Right panel: order summary */
    .summary{
      padding: 14px;
      display:flex;
      flex-direction: column;
      gap: 12px;
    }

    .summaryBox{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.92);
      border-radius: var(--radius2);
      padding: 12px;
    }

    .summaryTitle{
      margin:0 0 6px;
      font-weight: 900;
      font-size: 14px;
    }

    .summaryList{
      margin:0;
      padding-left: 18px;
      color: rgba(31,35,40,.86);
      line-height: 1.65;
      font-size: 13px;
    }

    .small{
      color: var(--muted);
      font-size: 12px;
      line-height: 1.6;
    }

    .cta{
      padding: 14px;
      border-top: 1px solid var(--line);
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items:center;
      justify-content: space-between;
      background: rgba(255,255,255,.78);
    }

    .ctaMain{
      display:flex;
      flex-direction: column;
      gap: 4px;
    }
    .ctaBig{
      font-weight: 900;
      font-size: 14px;
    }

    .btn.big{
      padding: 12px 14px;
      border-radius: 16px;
    }

    /* Toast */
    .toast{
      position: fixed;
      right: 16px;
      bottom: 16px;
      width: min(380px, calc(100vw - 32px));
      background: rgba(255,255,255,.92);
      border: 1px solid rgba(31,35,40,.10);
      border-radius: 16px;
      box-shadow: var(--shadow);
      padding: 12px 12px;
      display:none;
      gap: 8px;
      align-items:flex-start;
    }
    .toast.show{ display:flex; }
    .toast b{ font-size: 13px; }
    .toast .t{
      font-size: 12px;
      color: var(--muted);
      line-height: 1.6;
      margin-top: 2px;
    }

    /* Modal */
    .modal{
      position: fixed;
      inset: 0;
      background: rgba(31,35,40,.55);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index: 999;
    }
    .modal.show{ display:flex; }
    .modalCard{
      width: min(720px, 100%);
      border-radius: 22px;
      background: rgba(255,255,255,.94);
      border: 1px solid rgba(255,255,255,.20);
      box-shadow: 0 24px 70px rgba(0,0,0,.25);
      overflow:hidden;
    }
    .modalHead{
      padding: 12px 12px;
      border-bottom: 1px solid rgba(31,35,40,.10);
      display:flex;
      justify-content: space-between;
      align-items:center;
      gap: 10px;
    }
    .modalHead .title{
      font-weight: 900;
      font-size: 13px;
      color: rgba(31,35,40,.85);
      overflow:hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
      max-width: 70%;
    }
    .modalBody{
      padding: 12px;
      display:flex;
      flex-direction: column;
      gap: 10px;
    }

    .formGrid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    @media(min-width: 560px){
      .formGrid{ grid-template-columns: 1fr 1fr; }
    }
    .label{
      font-size: 12px;
      color: rgba(31,35,40,.72);
      margin-bottom: 6px;
    }
    .control{
      display:flex;
      flex-direction: column;
      gap: 6px;
    }
    .select{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.92);
      padding: 10px 12px;
      border-radius: 14px;
      outline:none;
    }

    /* Image preview modal */
    .imgModalBody{
      padding: 10px;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(255,255,255,.78);
    }
    .imgModalBody img{
      max-width: 100%;
      max-height: 78vh;
      border-radius: 16px;
      display:block;
    }

    footer{
      margin-top: 18px;
      color: var(--muted);
      font-size: 12px;
      text-align: center;
      line-height: 1.7;
      padding: 10px 0;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <section class="hero">
      <div class="heroTop">
        <div>
          <h1>èƒ–æ¬£æ¬£ &amp; ç˜¦åª›åª›çš„ä¸“å±æƒ…äººèŠ‚</h1>
          <div class="sub">
            <div>â€œç˜¦åª›åª›è´Ÿè´£ç‚¹é¤ï¼Œèƒ–æ¬£æ¬£è´Ÿè´£æ¸…ç›˜ï¼ˆå’Œä¹°å•ï¼‰ã€‚â€</div>
            <div>â€œä»Šæ—¥èœå•ï¼šå”¯æœ‰çˆ±ä¸ç¾é£Ÿä¸å¯è¾œè´Ÿã€‚â€</div>
            <div>â€œç‚¹å‡»ç¡®è®¤ä¸‹å•ï¼Œçˆ±æƒ…å³åˆ»é€è¾¾ã€‚â€</div>
          </div>
          <div class="quoteRow">
            <span class="chip">ğŸ’¾ æ–‡æ¡ˆ/é€‰æ‹© è‡ªåŠ¨ä¿å­˜ï¼ˆLocalStorageï¼‰</span>
            <span class="chip">ğŸ“· é«˜æ¸…åŸå›¾ IndexedDBï¼ˆä¸å¡ã€ä¸ä¸¢ï¼‰</span>
            <span class="chip">ğŸ“© ä¸‹å•é‚®ä»¶é€šçŸ¥ï¼ˆFormspreeï¼‰</span>
            <span class="chip">ğŸ§ æç®€è«å…°è¿ª + å¤§ç•™ç™½</span>
          </div>
        </div>

        <div class="heroActions">
          <button class="btn primary" id="btnAddDish">ï¼‹ æ–°å¢èœå“</button>
          <button class="btn sage" id="btnAddWish">ï¼‹ æ–°å¢å¿ƒæ„¿</button>
          <button class="btn" id="btnExport">å¯¼å‡º JSON</button>
          <button class="btn" id="btnImport">å¯¼å…¥ JSON</button>
          <button class="btn danger" id="btnReset">æ¸…ç©ºæ‰€æœ‰æ•°æ®</button>
          <input id="importFile" type="file" accept="application/json" style="display:none" />
        </div>
      </div>
    </section>

    <div class="grid">
      <!-- Left: Menu -->
      <section class="panel">
        <div class="panelHead">
          <div>
            <h2 class="panelTitle">ä¸‰åˆä¸€èœå•ï¼ˆä¸­ / éŸ© / è¥¿ï¼‰</h2>
            <div class="panelDesc">å…± 50 é“é¢„è®¾èœå“ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªç”±å¢åˆ æ”¹ï¼›æ¯å¼ å¡æ”¯æŒä¸Šä¼ ç…§ç‰‡ï¼ˆé«˜æ¸…å­˜æœ¬åœ°ï¼‰ã€‚</div>

            <div class="tabs" id="tabs"></div>

            <div class="searchRow">
              <input class="field" id="search" placeholder="æœç´¢èœå / æ ‡ç­¾ï¼ˆæ¯”å¦‚ï¼šç‰›ã€è¾£ã€æ±¤ã€ç”œï¼‰" />
              <button class="btn" id="btnClearSearch">æ¸…ç©º</button>
            </div>
          </div>
        </div>

        <div class="content">
          <div class="cards" id="dishGrid"></div>
        </div>
      </section>

      <!-- Right: Wishlist + Order -->
      <section class="panel">
        <div class="panelHead">
          <div>
            <h2 class="panelTitle">å¿ƒæ„¿æ¸…å•</h2>
            <div class="panelDesc">å†™ä¸‹æƒ³è¦çš„ç¤¼ç‰©/å°æ„¿æœ›ï¼Œå®æ—¶æ·»åŠ æˆå¡ç‰‡ã€‚èƒ–æ¬£æ¬£ï¼šæ”¶åˆ°âœ…</div>
          </div>
        </div>

        <div class="content">
          <div class="cards" id="wishGrid" style="grid-template-columns:1fr;"></div>
        </div>

        <div class="cta">
          <div class="ctaMain">
            <div class="ctaBig">ç¡®è®¤è®¢å•</div>
            <div class="small">ä¼šä¿å­˜åˆ°æœ¬åœ°ï¼Œå¹¶é€šè¿‡ Formspree å‘é€é‚®ä»¶é€šçŸ¥ï¼ˆéœ€è¦ä½ å¡« endpointï¼‰ã€‚</div>
          </div>
          <button class="btn primary big" id="btnConfirm">ç¡®è®¤ä¸‹å• Â· çˆ±æƒ…é€è¾¾</button>
        </div>

        <div class="summary">
          <div class="summaryBox">
            <p class="summaryTitle">å·²é€‰èœå•</p>
            <ol class="summaryList" id="selectedList"></ol>
            <div class="small" id="selectedEmpty">ï¼ˆè¿˜æ²¡é€‰èœï¼Œå…ˆç‚¹å‹¾é€‰ï½ï¼‰</div>
          </div>

          <div class="summaryBox">
            <p class="summaryTitle">å¿ƒæ„¿æ¸…å•</p>
            <ol class="summaryList" id="wishSummary"></ol>
            <div class="small" id="wishEmpty">ï¼ˆè¿˜æ²¡å†™å¿ƒæ„¿ï¼Œå¿«å†™ä¸€ä¸ªè®©èƒ–æ¬£æ¬£ç´§å¼ ä¸€ä¸‹ã€‚ï¼‰</div>
          </div>

          <div class="summaryBox">
            <p class="summaryTitle">é‚®ä»¶é€šçŸ¥è®¾ç½®</p>
            <div class="small">
              1) å» Formspree åˆ›å»ºè¡¨å•æ‹¿åˆ° endpointï¼ˆå½¢å¦‚ https://formspree.io/f/xxxxxxï¼‰ã€‚<br/>
              2) æŠŠä¸‹é¢è¾“å…¥æ¡†å¡«å¥½ï¼›ä¸‹å•ä¼šæŠŠè®¢å•ä¿¡æ¯å‘åˆ°ä½  Formspree ç»‘å®šçš„é‚®ç®±ã€‚<br/>
              3) å¦‚æœä½ æƒ³â€œå‘åˆ°æŒ‡å®šé‚®ç®±â€ï¼Œåœ¨ Formspree åå°æŠŠè½¬å‘é‚®ç®±è®¾ç½®æˆä½ æŒ‡å®šçš„é‚£ä¸ªã€‚
            </div>
            <div style="height:10px"></div>
            <input class="field" id="formspreeEndpoint" placeholder="Formspree Endpointï¼šä¾‹å¦‚ https://formspree.io/f/xxxxxx" />
            <div style="height:10px"></div>
            <input class="field" id="yourEmailHint" placeholder="ä½ çš„é‚®ç®±ï¼ˆä»…ä½œä¸ºè®¢å•å†…å®¹å­—æ®µï¼Œå¯ä¸å¡«ï¼‰" />
          </div>
        </div>
      </section>
    </div>

    <footer>
      GitHub Pagesï¼šæŠŠæœ¬æ–‡ä»¶å‘½åä¸º <b>index.html</b> æ”¾åˆ°ä»“åº“æ ¹ç›®å½• â†’ Settings â†’ Pages â†’ é€‰æ‹©åˆ†æ”¯éƒ¨ç½²ã€‚<br/>
      æœ¬é¡µé¢ä¸éœ€è¦åç«¯ï¼›å›¾ç‰‡é«˜æ¸…åŸå›¾å­˜ IndexedDBã€ç¼©ç•¥å›¾/æ–‡æœ¬/é€‰æ‹©å­˜ LocalStorageã€‚
    </footer>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast">
    <div style="font-size:16px;line-height:1">âœ¨</div>
    <div>
      <b id="toastTitle">æç¤º</b>
      <div class="t" id="toastMsg"></div>
    </div>
  </div>

  <!-- Modal: Add/Edit Dish -->
  <div class="modal" id="dishModal">
    <div class="modalCard">
      <div class="modalHead">
        <div class="title" id="dishModalTitle">æ–°å¢èœå“</div>
        <button class="btn" id="dishModalClose">å…³é—­</button>
      </div>
      <div class="modalBody">
        <div class="formGrid">
          <div class="control">
            <div class="label">èœå</div>
            <input class="field" id="dishName" placeholder="ä¾‹å¦‚ï¼šé»‘æ¤’ç‰›æ’" />
          </div>
          <div class="control">
            <div class="label">åˆ†ç±»</div>
            <select class="select" id="dishCuisine">
              <option value="ä¸­é¤">ä¸­é¤</option>
              <option value="éŸ©é¤">éŸ©é¤</option>
              <option value="è¥¿é¤">è¥¿é¤</option>
            </select>
          </div>
          <div class="control">
            <div class="label">æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰</div>
            <input class="field" id="dishTags" placeholder="ä¾‹å¦‚ï¼šå¾®è¾£/æš–èƒƒ/ç”œ" />
          </div>
          <div class="control">
            <div class="label">ä»·æ ¼ï¼ˆå¯é€‰ï¼‰</div>
            <input class="field" id="dishPrice" placeholder="ä¾‹å¦‚ï¼š58" inputmode="numeric" />
          </div>
        </div>
        <div class="control">
          <div class="label">å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰</div>
          <textarea class="note" id="dishNote" placeholder="ä¾‹å¦‚ï¼šç˜¦åª›åª›ç‚¹çš„ï¼Œèƒ–æ¬£æ¬£å¿…é¡»è¯´å¥½åƒ"></textarea>
        </div>

        <div class="btnRow">
          <button class="btn primary" id="dishSave">ä¿å­˜</button>
          <button class="btn" id="dishCancel">å–æ¶ˆ</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: Add/Edit Wish -->
  <div class="modal" id="wishModal">
    <div class="modalCard">
      <div class="modalHead">
        <div class="title" id="wishModalTitle">æ–°å¢å¿ƒæ„¿</div>
        <button class="btn" id="wishModalClose">å…³é—­</button>
      </div>
      <div class="modalBody">
        <div class="control">
          <div class="label">å¿ƒæ„¿æ ‡é¢˜</div>
          <input class="field" id="wishTitleInput" placeholder="ä¾‹å¦‚ï¼šä¸€æŸå¥¶æ²¹ç™½ç«ç‘°" />
        </div>
        <div class="control">
          <div class="label">å¿ƒæ„¿æè¿°ï¼ˆå¯é€‰ï¼‰</div>
          <textarea class="note" id="wishDescInput" placeholder="ä¾‹å¦‚ï¼šä¸è¦å¤ªå¤¸å¼ ï¼Œè¦åƒä½ ä¸€æ ·é«˜çº§ã€‚"></textarea>
        </div>
        <div class="btnRow">
          <button class="btn primary" id="wishSave">ä¿å­˜</button>
          <button class="btn" id="wishCancel">å–æ¶ˆ</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: Full Image Preview -->
  <div class="modal" id="imgModal">
    <div class="modalCard" style="width:min(980px,100%)">
      <div class="modalHead">
        <div class="title" id="imgModalTitle">é«˜æ¸…é¢„è§ˆ</div>
        <button class="btn" id="imgModalClose">å…³é—­</button>
      </div>
      <div class="imgModalBody">
        <img id="imgModalImg" alt="full" />
      </div>
    </div>
  </div>

  <script>
    /*****************************************************************
     * Core requirements
     * - 50 preset dishes (Chinese/Korean/Western) with categories
     * - CRUD: dish cards have Edit/Delete, plus global "æ–°å¢èœå“"
     * - Wishlist: dynamic add/edit/delete
     * - Auto-save: LocalStorage for text/selection/thumbs
     * - HD photo storage: IndexedDB for original blobs; thumbnails in LS
     * - Confirm order: save to local AND send email via Formspree endpoint
     *****************************************************************/

    // ===== Storage Keys =====
    const LS_DISHES = "pxxy_dishes_v3";
    const LS_WISHES = "pxxy_wishes_v3";
    const LS_SETTINGS = "pxxy_settings_v3";
    const LS_ORDERS = "pxxy_orders_v3";

    // IndexedDB
    const DB_NAME = "pxxy_images_db_v3";
    const STORE = "images";

    // ===== State =====
    let dishes = [];
    let wishes = [];
    let filterCuisine = "å…¨éƒ¨";
    let searchQuery = "";

    // Modal editing
    let editingDishId = null;
    let editingWishId = null;

    // ===== DOM =====
    const tabsEl = document.getElementById("tabs");
    const searchEl = document.getElementById("search");
    const dishGrid = document.getElementById("dishGrid");
    const wishGrid = document.getElementById("wishGrid");

    const selectedList = document.getElementById("selectedList");
    const selectedEmpty = document.getElementById("selectedEmpty");
    const wishSummary = document.getElementById("wishSummary");
    const wishEmpty = document.getElementById("wishEmpty");

    const endpointEl = document.getElementById("formspreeEndpoint");
    const emailHintEl = document.getElementById("yourEmailHint");

    // Toast
    const toast = document.getElementById("toast");
    const toastTitle = document.getElementById("toastTitle");
    const toastMsg = document.getElementById("toastMsg");
    let toastTimer = null;

    // Modals
    const dishModal = document.getElementById("dishModal");
    const dishModalTitle = document.getElementById("dishModalTitle");
    const dishName = document.getElementById("dishName");
    const dishCuisine = document.getElementById("dishCuisine");
    const dishTags = document.getElementById("dishTags");
    const dishPrice = document.getElementById("dishPrice");
    const dishNote = document.getElementById("dishNote");

    const wishModal = document.getElementById("wishModal");
    const wishModalTitle = document.getElementById("wishModalTitle");
    const wishTitleInput = document.getElementById("wishTitleInput");
    const wishDescInput = document.getElementById("wishDescInput");

    const imgModal = document.getElementById("imgModal");
    const imgModalTitle = document.getElementById("imgModalTitle");
    const imgModalImg = document.getElementById("imgModalImg");

    // ===== Init =====
    loadAll();
    renderAll();

    // ===== Event bindings =====
    document.getElementById("btnAddDish").addEventListener("click", () => openDishModal(null));
    document.getElementById("btnAddWish").addEventListener("click", () => openWishModal(null));

    document.getElementById("btnClearSearch").addEventListener("click", () => {
      searchQuery = "";
      searchEl.value = "";
      renderAll();
    });

    searchEl.addEventListener("input", debounce(() => {
      searchQuery = (searchEl.value || "").trim();
      renderAll();
    }, 120));

    // Export / Import
    const importFile = document.getElementById("importFile");
    document.getElementById("btnImport").addEventListener("click", () => importFile.click());
    importFile.addEventListener("change", async () => {
      const f = importFile.files && importFile.files[0];
      if (!f) return;
      try{
        const data = JSON.parse(await f.text());
        if (!data || typeof data !== "object") throw new Error("JSON æ— æ•ˆ");

        dishes = Array.isArray(data.dishes) ? data.dishes : dishes;
        wishes = Array.isArray(data.wishes) ? data.wishes : wishes;

        saveLS(LS_DISHES, dishes);
        saveLS(LS_WISHES, wishes);

        // settings optional
        if (data.settings && typeof data.settings === "object") {
          saveLS(LS_SETTINGS, data.settings);
          applySettingsFromLS();
        }

        renderAll();
        showToast("å¯¼å…¥æˆåŠŸ", "æ–‡æœ¬/é€‰æ‹©/ç¼©ç•¥å›¾å·²æ¢å¤ã€‚åŸå›¾ä»åœ¨ IndexedDBï¼ˆè‹¥æ¢è®¾å¤‡éœ€é‡æ–°ä¸Šä¼ ï¼‰ã€‚");
      }catch(e){
        showToast("å¯¼å…¥å¤±è´¥", e?.message || String(e));
      }finally{
        importFile.value = "";
      }
    });

    document.getElementById("btnExport").addEventListener("click", () => {
      const payload = {
        version: 3,
        exportedAt: Date.now(),
        dishes,
        wishes,
        settings: loadLS(LS_SETTINGS) || {},
        note: "åŸå›¾é«˜æ¸…å­˜ IndexedDBï¼Œä¸åœ¨ JSON å†…ï¼›JSON å†…åªåŒ…å«ç¼©ç•¥å›¾ dataURLã€‚"
      };
      const blob = new Blob([JSON.stringify(payload, null, 2)], {type:"application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "èƒ–æ¬£æ¬£_ç˜¦åª›åª›_æƒ…äººèŠ‚_æ•°æ®.json";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
      showToast("å·²å¯¼å‡º", "JSON å·²ä¸‹è½½ï¼ˆåŸå›¾ä¸åŒ…å«åœ¨å†…ï¼‰ã€‚");
    });

    document.getElementById("btnReset").addEventListener("click", async () => {
      if (!confirm("ç¡®å®šæ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿï¼ˆLocalStorage + IndexedDB å›¾ç‰‡ï¼‰")) return;
      localStorage.removeItem(LS_DISHES);
      localStorage.removeItem(LS_WISHES);
      localStorage.removeItem(LS_SETTINGS);
      localStorage.removeItem(LS_ORDERS);
      dishes = [];
      wishes = [];
      await idbClearAll();
      loadAll(); // rehydrate presets
      renderAll();
      showToast("å·²æ¸…ç©º", "å·²æ¢å¤åˆ°é»˜è®¤ 50 é“èœï¼ˆå›¾ç‰‡å·²æ¸…ç©ºï¼‰ã€‚");
    });

    // Settings autosave
    endpointEl.addEventListener("input", debounce(saveSettings, 200));
    emailHintEl.addEventListener("input", debounce(saveSettings, 200));

    // Confirm order
    document.getElementById("btnConfirm").addEventListener("click", confirmOrder);

    // Dish modal
    document.getElementById("dishModalClose").addEventListener("click", closeDishModal);
    document.getElementById("dishCancel").addEventListener("click", closeDishModal);
    document.getElementById("dishSave").addEventListener("click", saveDishFromModal);
    dishModal.addEventListener("click", (e) => { if (e.target === dishModal) closeDishModal(); });

    // Wish modal
    document.getElementById("wishModalClose").addEventListener("click", closeWishModal);
    document.getElementById("wishCancel").addEventListener("click", closeWishModal);
    document.getElementById("wishSave").addEventListener("click", saveWishFromModal);
    wishModal.addEventListener("click", (e) => { if (e.target === wishModal) closeWishModal(); });

    // Image modal
    document.getElementById("imgModalClose").addEventListener("click", closeImgModal);
    imgModal.addEventListener("click", (e) => { if (e.target === imgModal) closeImgModal(); });

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape"){
        closeDishModal();
        closeWishModal();
        closeImgModal();
      }
    });

    // ===== Data bootstrap =====
    function loadAll(){
      // Dishes
      const lsD = loadLS(LS_DISHES);
      if (Array.isArray(lsD) && lsD.length){
        dishes = lsD;
      }else{
        dishes = makePresetDishes50();
        saveLS(LS_DISHES, dishes);
      }

      // Wishes
      const lsW = loadLS(LS_WISHES);
      wishes = Array.isArray(lsW) ? lsW : [];
      if (!Array.isArray(lsW)) saveLS(LS_WISHES, wishes);

      applySettingsFromLS();
    }

    function applySettingsFromLS(){
      const s = loadLS(LS_SETTINGS) || {};
      endpointEl.value = s.formspreeEndpoint || "";
      emailHintEl.value = s.yourEmailHint || "";
    }

    function saveSettings(){
      saveLS(LS_SETTINGS, {
        formspreeEndpoint: (endpointEl.value || "").trim(),
        yourEmailHint: (emailHintEl.value || "").trim()
      });
    }

    function makePresetDishes50(){
      // 50 items: ä¸­é¤ 20 / éŸ©é¤ 15 / è¥¿é¤ 15
      const base = [
        // ä¸­é¤ 20
        ["ä¸­é¤","çº¢çƒ§è‚‰","å®¶å¸¸/ä¸‹é¥­","58"],
        ["ä¸­é¤","å®«ä¿é¸¡ä¸","å¾®è¾£/ç»å…¸","42"],
        ["ä¸­é¤","æ°´ç…®ç‰›è‚‰","é‡è¾£/è¿‡ç˜¾","68"],
        ["ä¸­é¤","é…¸èœé±¼","é…¸çˆ½/æš–èƒƒ","66"],
        ["ä¸­é¤","éº»å©†è±†è…","éº»è¾£/æ‹Œé¥­","32"],
        ["ä¸­é¤","å°ç‚’é»„ç‰›è‚‰","é¦™è¾£/çˆ†ç‚’","62"],
        ["ä¸­é¤","ç³–é†‹é‡Œè„Š","é…¸ç”œ/å¼€èƒƒ","48"],
        ["ä¸­é¤","è‘±çˆ†ç¾Šè‚‰","è‘±é¦™/ä¸‹é…’","72"],
        ["ä¸­é¤","æ¸…è’¸é²ˆé±¼","æ¸…çˆ½/é²œ","78"],
        ["ä¸­é¤","è™¾ä»æ»‘è›‹","è½¯å«©/æ²»æ„ˆ","45"],
        ["ä¸­é¤","ç•ªèŒ„ç‰›è…©","æµ“éƒ/æ±¤æ±","74"],
        ["ä¸­é¤","çƒ¤é¸­å·","ä»ªå¼æ„Ÿ","88"],
        ["ä¸­é¤","è’œè“‰ç²‰ä¸è’¸æ‰‡è´","è’œé¦™/æµ·å‘³","76"],
        ["ä¸­é¤","æ‹…æ‹…é¢","å¾®éº»/é¦™","28"],
        ["ä¸­é¤","ç‰›è‚‰é¢ï¼ˆçº¢çƒ§ï¼‰","æš–èƒƒ/é¥±è¶³","32"],
        ["ä¸­é¤","é…¸è¾£æ±¤","å¼€èƒƒ/çƒ­ä¹","22"],
        ["ä¸­é¤","è›‹ç‚’é¥­","ç»å…¸/ä¸è¸©é›·","18"],
        ["ä¸­é¤","é”…åŒ…è‚‰","å¤–é…¥é‡Œå«©","52"],
        ["ä¸­é¤","æ¤’ç›æ’éª¨","é…¥é¦™/å’¸é¦™","58"],
        ["ä¸­é¤","åŒçš®å¥¶","ç”œå“/æ¸©æŸ”","20"],

        // éŸ©é¤ 15
        ["éŸ©é¤","éƒ¨é˜Ÿé”…","æµ“éƒ/çƒ­è¾£","72"],
        ["éŸ©é¤","æ³¡èœç‚’é¥­","é…¸è¾£/é¦™","36"],
        ["éŸ©é¤","éŸ©å¼ç‚¸é¸¡","é…¥è„†/ç”œè¾£","56"],
        ["éŸ©é¤","çŸ³é”…æ‹Œé¥­","å‡è¡¡/æ»¡è¶³","48"],
        ["éŸ©é¤","å‚é¸¡æ±¤","æ»‹è¡¥/æš–","88"],
        ["éŸ©é¤","æµ·é²œè±†è…æ±¤","é²œè¾£/çƒ­ä¹","46"],
        ["éŸ©é¤","èŠå£«å¹´ç³•","æ‹‰ä¸/ç½ªæ¶","44"],
        ["éŸ©é¤","çƒ¤äº”èŠ±è‚‰","é¦™/æ»¡è¶³","68"],
        ["éŸ©é¤","çƒ¤ç‰›å°æ’","é«˜çº§/é¦™","98"],
        ["éŸ©é¤","å†·é¢","æ¸…çˆ½/è§£è…»","34"],
        ["éŸ©é¤","è¾£ç‚’é±¿é±¼","é¦™è¾£/ä¸‹é¥­","58"],
        ["éŸ©é¤","ç´«èœåŒ…é¥­","æ¸…çˆ½/æ–¹ä¾¿","28"],
        ["éŸ©é¤","æ³¡èœé¥¼","å¤–è„†/é…¸é¦™","32"],
        ["éŸ©é¤","èœ‚èœœæŸšå­èŒ¶","æ¸…ç”œ","16"],
        ["éŸ©é¤","è‰è“ç‰›å¥¶","ç”œç”œ","18"],

        // è¥¿é¤ 15
        ["è¥¿é¤","é»‘æ¤’ç‰›æ’","é«˜çº§/æ»¡è¶³","128"],
        ["è¥¿é¤","å¥¶æ²¹è˜‘è‡æ„é¢","æ²»æ„ˆ/æ¸©æŸ”","68"],
        ["è¥¿é¤","ç•ªèŒ„æµ·é²œæ„é¢","é²œ/é…¸ç”œ","76"],
        ["è¥¿é¤","å‡¯æ’’æ²™æ‹‰","æ¸…çˆ½/è½»ç›ˆ","42"],
        ["è¥¿é¤","çƒ¤ä¸‰æ–‡é±¼","æ¸…çˆ½/é²œ","118"],
        ["è¥¿é¤","çƒ¤é¸¡è…¿é…åœŸè±†","å®¶å¸¸/é¦™","88"],
        ["è¥¿é¤","è˜‘è‡æµ“æ±¤","æš–èƒƒ","36"],
        ["è¥¿é¤","æ³•å¼æ´‹è‘±æ±¤","å±‚æ¬¡/é¦™","46"],
        ["è¥¿é¤","èŠå£«æŠ«è¨","æ‹‰ä¸/å¿«ä¹","78"],
        ["è¥¿é¤","ç›æ ¼ä¸½ç‰¹æŠ«è¨","ç»å…¸","72"],
        ["è¥¿é¤","ææ‹‰ç±³è‹","ç”œå“/æ°›å›´","38"],
        ["è¥¿é¤","è‰è“å¥¶æ²¹è›‹ç³•","ç”œ/æµªæ¼«","42"],
        ["è¥¿é¤","ç„¦ç³–å¸ƒä¸","ä¸æ»‘","28"],
        ["è¥¿é¤","æ— é…’ç²¾èµ·æ³¡é…’","ä»ªå¼æ„Ÿ","26"],
        ["è¥¿é¤","çƒ­å¯å¯","æš–å¿ƒ","18"],
      ];

      return base.map(([cuisine, name, tags, price], idx) => ({
        id: crypto.randomUUID(),
        cuisine,
        name,
        tags,
        price,
        note: "",
        selected: false,
        thumbDataUrl: null,     // small thumb stored in LS
        imageBlobKey: null,     // full-res blob stored in IndexedDB
        updatedAt: Date.now() - (base.length - idx) * 1000
      }));
    }

    // ===== Render =====
    function renderAll(){
      renderTabs();
      renderDishes();
      renderWishes();
      renderSummary();
      saveSettings(); // keep latest
    }

    function renderTabs(){
      const allCount = dishes.length;
      const cn = dishes.filter(d => d.cuisine==="ä¸­é¤").length;
      const kr = dishes.filter(d => d.cuisine==="éŸ©é¤").length;
      const we = dishes.filter(d => d.cuisine==="è¥¿é¤").length;

      const tabs = [
        ["å…¨éƒ¨", `å…¨éƒ¨ (${allCount})`],
        ["ä¸­é¤", `ä¸­é¤ (${cn})`],
        ["éŸ©é¤", `éŸ©é¤ (${kr})`],
        ["è¥¿é¤", `è¥¿é¤ (${we})`]
      ];

      tabsEl.innerHTML = "";
      tabs.forEach(([key, label]) => {
        const t = document.createElement("div");
        t.className = "tab" + (filterCuisine===key ? " active" : "");
        t.textContent = label;
        t.addEventListener("click", () => {
          filterCuisine = key;
          renderAll();
        });
        tabsEl.appendChild(t);
      });
    }

    function renderDishes(){
      const q = searchQuery.toLowerCase();
      const list = dishes.filter(d => {
        if (filterCuisine !== "å…¨éƒ¨" && d.cuisine !== filterCuisine) return false;
        if (!q) return true;
        return (d.name + " " + (d.tags||"") + " " + (d.note||"")).toLowerCase().includes(q);
      });

      dishGrid.innerHTML = "";
      if (!list.length){
        dishGrid.innerHTML = `<div class="small">æ²¡æœ‰åŒ¹é…ç»“æœï½ï¼ˆè¦ä¸æ¢ä¸ªå…³é”®è¯ï¼Ÿï¼‰</div>`;
        return;
      }

      for (const dish of list){
        dishGrid.appendChild(renderDishCard(dish));
      }
    }

    function renderDishCard(d){
      const card = document.createElement("div");
      card.className = "card";

      const thumb = document.createElement("div");
      thumb.className = "thumb";
      const img = document.createElement("img");
      img.loading = "lazy";
      img.decoding = "async";

      if (d.thumbDataUrl){
        img.src = d.thumbDataUrl;
      }else{
        img.style.opacity = "0";
      }

      thumb.appendChild(img);

      const hint = document.createElement("div");
      hint.className = "thumbHint";
      const p1 = document.createElement("div");
      p1.className = "pill";
      p1.textContent = d.thumbDataUrl ? "ç‚¹æˆ‘çœ‹é«˜æ¸… / æ¢å›¾" : "ä¸Šä¼ ç…§ç‰‡ï¼ˆé«˜æ¸…ï¼‰";
      const p2 = document.createElement("div");
      p2.className = "pill";
      p2.textContent = d.cuisine;
      hint.append(p1, p2);
      thumb.appendChild(hint);

      const body = document.createElement("div");
      body.className = "cardBody";

      const top = document.createElement("div");
      top.className = "row";
      const name = document.createElement("p");
      name.className = "name";
      name.textContent = d.name;

      const meta = document.createElement("div");
      meta.className = "meta";
      const b1 = document.createElement("span");
      b1.className = "badge";
      b1.textContent = d.tags || "â€”";
      const b2 = document.createElement("span");
      b2.className = "price";
      b2.textContent = d.price ? "Â¥ " + d.price : "Â¥ â€”";
      meta.append(b1, b2);

      top.append(name, meta);

      const note = document.createElement("textarea");
      note.className = "note";
      note.placeholder = "å†™ç‚¹å¯çˆ±å¤‡æ³¨ï¼šä¸è¦é¦™èœ/è¦åŠ è¾£/ç˜¦åª›åª›è¯´è¿™é“å¿…é¡»ç‚¹â€¦";
      note.value = d.note || "";

      const selectRow = document.createElement("div");
      selectRow.className = "selectRow";
      const toggle = document.createElement("label");
      toggle.className = "toggle";
      const cb = document.createElement("input");
      cb.type = "checkbox";
      cb.checked = !!d.selected;
      const span = document.createElement("span");
      span.textContent = d.selected ? "å·²é€‰ä¸­ï¼ˆèƒ–æ¬£æ¬£å‡†å¤‡æ¸…ç›˜ï¼‰" : "åŠ å…¥è®¢å•";
      toggle.append(cb, span);

      cb.addEventListener("change", () => {
        d.selected = cb.checked;
        span.textContent = d.selected ? "å·²é€‰ä¸­ï¼ˆèƒ–æ¬£æ¬£å‡†å¤‡æ¸…ç›˜ï¼‰" : "åŠ å…¥è®¢å•";
        d.updatedAt = Date.now();
        saveLS(LS_DISHES, dishes);
        renderSummary();
      });

      // Buttons
      const btnRow = document.createElement("div");
      btnRow.className = "btnRow";
      const btnEdit = document.createElement("button");
      btnEdit.className = "btn";
      btnEdit.textContent = "ç¼–è¾‘";
      btnEdit.addEventListener("click", () => openDishModal(d.id));

      const btnDel = document.createElement("button");
      btnDel.className = "btn danger";
      btnDel.textContent = "åˆ é™¤";
      btnDel.addEventListener("click", () => {
        if (!confirm(`ç¡®å®šåˆ é™¤ã€Œ${d.name}ã€å—ï¼Ÿ`)) return;
        // remove from list
        dishes = dishes.filter(x => x.id !== d.id);
        saveLS(LS_DISHES, dishes);
        renderAll();
        showToast("å·²åˆ é™¤", "è¿™é“èœè¢«èƒ–æ¬£æ¬£æ‚„æ‚„åˆ’æ‰äº†ã€‚");
      });

      const btnUpload = document.createElement("button");
      btnUpload.className = "btn primary";
      btnUpload.textContent = "ä¸Šä¼ /æ›´æ¢ç…§ç‰‡";
      btnUpload.addEventListener("click", () => fileInput.click());

      btnRow.append(btnUpload, btnEdit, btnDel);

      selectRow.append(toggle);

      body.append(top, note, selectRow, btnRow);

      // hidden file input
      const fileInput = document.createElement("input");
      fileInput.type = "file";
      fileInput.accept = "image/*";
      fileInput.style.display = "none";

      fileInput.addEventListener("change", async () => {
        const file = fileInput.files && fileInput.files[0];
        if (!file) return;

        const MAX_MB = 15;
        if (file.size > MAX_MB * 1024 * 1024){
          showToast("å›¾ç‰‡å¤ªå¤§", `è¶…è¿‡ ${MAX_MB}MBï¼Œå»ºè®®å‹ç¼©åå†ä¸Šä¼ ã€‚`);
          fileInput.value = "";
          return;
        }

        const blobKey = `dish:${d.id}:full`;
        await idbSet(blobKey, file);

        const thumbUrl = await makeThumbnailDataUrl(file, 900, 0.86);

        d.imageBlobKey = blobKey;
        d.thumbDataUrl = thumbUrl;
        d.updatedAt = Date.now();

        saveLS(LS_DISHES, dishes);
        renderDishes();
        showToast("å·²ä¿å­˜å›¾ç‰‡", "åŸå›¾å·²å­˜ IndexedDBï¼Œç¼©ç•¥å›¾ç”¨äºå¿«é€Ÿæ˜¾ç¤ºã€‚");

        fileInput.value = "";
      });

      // note autosave
      note.addEventListener("input", debounce(() => {
        d.note = note.value;
        d.updatedAt = Date.now();
        saveLS(LS_DISHES, dishes);
        renderSummary();
      }, 220));

      // click thumb to view full / upload
      thumb.addEventListener("click", async () => {
        if (!d.imageBlobKey){
          fileInput.click();
          return;
        }
        await showFullImage(d.imageBlobKey, `${d.cuisine} Â· ${d.name}`);
      });

      card.append(thumb, body, fileInput);
      return card;
    }

    function renderWishes(){
      wishGrid.innerHTML = "";

      if (!wishes.length){
        wishGrid.innerHTML = `<div class="small">è¿˜æ²¡æœ‰å¿ƒæ„¿ï½ ç‚¹å³ä¸Šè§’ã€Œæ–°å¢å¿ƒæ„¿ã€å†™ä¸€ä¸ªå§ã€‚</div>`;
        return;
      }

      for (const w of wishes){
        wishGrid.appendChild(renderWishCard(w));
      }
    }

    function renderWishCard(w){
      const card = document.createElement("div");
      card.className = "card";
      card.style.minHeight = "260px";

      const thumb = document.createElement("div");
      thumb.className = "thumb";
      const img = document.createElement("img");
      img.loading = "lazy";
      img.decoding = "async";
      if (w.thumbDataUrl){
        img.src = w.thumbDataUrl;
      }else{
        img.style.opacity = "0";
      }
      thumb.appendChild(img);

      const hint = document.createElement("div");
      hint.className = "thumbHint";
      const p1 = document.createElement("div");
      p1.className = "pill";
      p1.textContent = w.thumbDataUrl ? "ç‚¹æˆ‘çœ‹é«˜æ¸… / æ¢å›¾" : "ç»™å¿ƒæ„¿é…å¼ å›¾ï¼ˆé«˜æ¸…ï¼‰";
      const p2 = document.createElement("div");
      p2.className = "pill";
      p2.textContent = "Wishlist";
      hint.append(p1, p2);
      thumb.appendChild(hint);

      const body = document.createElement("div");
      body.className = "cardBody";

      const top = document.createElement("div");
      top.className = "row";

      const name = document.createElement("p");
      name.className = "name";
      name.textContent = w.title;

      const meta = document.createElement("div");
      meta.className = "meta";
      const b = document.createElement("span");
      b.className = "badge";
      b.textContent = "å¿ƒæ„¿";
      meta.append(b);

      top.append(name, meta);

      const note = document.createElement("textarea");
      note.className = "note";
      note.placeholder = "å†™ç‚¹æè¿°ï¼šé¢œè‰²/é¢„ç®—/æƒ³è¦çš„æ„Ÿè§‰â€¦ï¼ˆèƒ–æ¬£æ¬£ä¼šè®¤çœŸçœ‹ï¼‰";
      note.value = w.desc || "";

      const btnRow = document.createElement("div");
      btnRow.className = "btnRow";

      const btnUpload = document.createElement("button");
      btnUpload.className = "btn primary";
      btnUpload.textContent = "ä¸Šä¼ /æ›´æ¢ç…§ç‰‡";
      btnUpload.addEventListener("click", () => fileInput.click());

      const btnEdit = document.createElement("button");
      btnEdit.className = "btn";
      btnEdit.textContent = "ç¼–è¾‘";
      btnEdit.addEventListener("click", () => openWishModal(w.id));

      const btnDel = document.createElement("button");
      btnDel.className = "btn danger";
      btnDel.textContent = "åˆ é™¤";
      btnDel.addEventListener("click", () => {
        if (!confirm(`ç¡®å®šåˆ é™¤å¿ƒæ„¿ã€Œ${w.title}ã€å—ï¼Ÿ`)) return;
        wishes = wishes.filter(x => x.id !== w.id);
        saveLS(LS_WISHES, wishes);
        renderAll();
        showToast("å·²åˆ é™¤", "å¿ƒæ„¿æš‚æ—¶è¢«æ”¶è¿›æŠ½å±‰é‡Œã€‚");
      });

      btnRow.append(btnUpload, btnEdit, btnDel);

      // hidden file input
      const fileInput = document.createElement("input");
      fileInput.type = "file";
      fileInput.accept = "image/*";
      fileInput.style.display = "none";

      fileInput.addEventListener("change", async () => {
        const file = fileInput.files && fileInput.files[0];
        if (!file) return;

        const MAX_MB = 15;
        if (file.size > MAX_MB * 1024 * 1024){
          showToast("å›¾ç‰‡å¤ªå¤§", `è¶…è¿‡ ${MAX_MB}MBï¼Œå»ºè®®å‹ç¼©åå†ä¸Šä¼ ã€‚`);
          fileInput.value = "";
          return;
        }

        const blobKey = `wish:${w.id}:full`;
        await idbSet(blobKey, file);

        const thumbUrl = await makeThumbnailDataUrl(file, 900, 0.86);

        w.imageBlobKey = blobKey;
        w.thumbDataUrl = thumbUrl;
        w.updatedAt = Date.now();

        saveLS(LS_WISHES, wishes);
        renderWishes();
        renderSummary();
        showToast("å·²ä¿å­˜å›¾ç‰‡", "åŸå›¾å·²å­˜ IndexedDBï¼Œç¼©ç•¥å›¾ç”¨äºå¿«é€Ÿæ˜¾ç¤ºã€‚");

        fileInput.value = "";
      });

      note.addEventListener("input", debounce(() => {
        w.desc = note.value;
        w.updatedAt = Date.now();
        saveLS(LS_WISHES, wishes);
        renderSummary();
      }, 220));

      thumb.addEventListener("click", async () => {
        if (!w.imageBlobKey){
          fileInput.click();
          return;
        }
        await showFullImage(w.imageBlobKey, `å¿ƒæ„¿ Â· ${w.title}`);
      });

      body.append(top, note, btnRow);
      card.append(thumb, body, fileInput);
      return card;
    }

    function renderSummary(){
      // Selected dishes
      const selected = dishes.filter(d => d.selected);
      selectedList.innerHTML = "";
      if (!selected.length){
        selectedEmpty.style.display = "block";
      }else{
        selectedEmpty.style.display = "none";
        selected.forEach(d => {
          const li = document.createElement("li");
          li.textContent = `${d.cuisine}ï½œ${d.name}${d.price ? `ï¼ˆÂ¥${d.price}ï¼‰` : ""}`;
          selectedList.appendChild(li);
        });
      }

      // Wishes summary
      wishSummary.innerHTML = "";
      if (!wishes.length){
        wishEmpty.style.display = "block";
      }else{
        wishEmpty.style.display = "none";
        wishes.forEach(w => {
          const li = document.createElement("li");
          li.textContent = w.title;
          wishSummary.appendChild(li);
        });
      }
    }

    // ===== Modals: Dish =====
    function openDishModal(id){
      editingDishId = id;
      if (!id){
        dishModalTitle.textContent = "æ–°å¢èœå“";
        dishName.value = "";
        dishCuisine.value = "ä¸­é¤";
        dishTags.value = "";
        dishPrice.value = "";
        dishNote.value = "";
      }else{
        const d = dishes.find(x => x.id === id);
        if (!d) return;
        dishModalTitle.textContent = "ç¼–è¾‘èœå“";
        dishName.value = d.name || "";
        dishCuisine.value = d.cuisine || "ä¸­é¤";
        dishTags.value = d.tags || "";
        dishPrice.value = d.price || "";
        dishNote.value = d.note || "";
      }
      dishModal.classList.add("show");
      setTimeout(() => dishName.focus(), 0);
    }
    function closeDishModal(){
      dishModal.classList.remove("show");
      editingDishId = null;
    }
    function saveDishFromModal(){
      const name = (dishName.value || "").trim();
      const cuisine = (dishCuisine.value || "").trim();
      const tags = (dishTags.value || "").trim();
      const price = (dishPrice.value || "").trim();
      const note = (dishNote.value || "").trim();

      if (!name){
        showToast("ç¼ºå°‘èœå", "è¯·å…ˆè¾“å…¥èœåï½");
        dishName.focus();
        return;
      }

      if (!editingDishId){
        dishes.unshift({
          id: crypto.randomUUID(),
          cuisine: cuisine || "ä¸­é¤",
          name,
          tags,
          price,
          note,
          selected: false,
          thumbDataUrl: null,
          imageBlobKey: null,
          updatedAt: Date.now()
        });
        saveLS(LS_DISHES, dishes);
        renderAll();
        closeDishModal();
        showToast("å·²æ–°å¢", "æ–°èœä¸Šçº¿ï¼Œç˜¦åª›åª›è¯·å®¡æ ¸âœ…");
      }else{
        const d = dishes.find(x => x.id === editingDishId);
        if (!d) return;
        d.name = name;
        d.cuisine = cuisine || d.cuisine;
        d.tags = tags;
        d.price = price;
        d.note = note;
        d.updatedAt = Date.now();
        saveLS(LS_DISHES, dishes);
        renderAll();
        closeDishModal();
        showToast("å·²ä¿å­˜", "ç¼–è¾‘å®Œæˆï¼Œèƒ–æ¬£æ¬£è¯´ï¼šæˆ‘éƒ½å¯ä»¥ã€‚");
      }
    }

    // ===== Modals: Wish =====
    function openWishModal(id){
      editingWishId = id;
      if (!id){
        wishModalTitle.textContent = "æ–°å¢å¿ƒæ„¿";
        wishTitleInput.value = "";
        wishDescInput.value = "";
      }else{
        const w = wishes.find(x => x.id === id);
        if (!w) return;
        wishModalTitle.textContent = "ç¼–è¾‘å¿ƒæ„¿";
        wishTitleInput.value = w.title || "";
        wishDescInput.value = w.desc || "";
      }
      wishModal.classList.add("show");
      setTimeout(() => wishTitleInput.focus(), 0);
    }
    function closeWishModal(){
      wishModal.classList.remove("show");
      editingWishId = null;
    }
    function saveWishFromModal(){
      const title = (wishTitleInput.value || "").trim();
      const desc = (wishDescInput.value || "").trim();
      if (!title){
        showToast("ç¼ºå°‘å¿ƒæ„¿æ ‡é¢˜", "å…ˆå†™ä¸€å¥ä½ æƒ³è¦çš„ï½");
        wishTitleInput.focus();
        return;
      }

      if (!editingWishId){
        wishes.unshift({
          id: crypto.randomUUID(),
          title,
          desc,
          thumbDataUrl: null,
          imageBlobKey: null,
          updatedAt: Date.now()
        });
        saveLS(LS_WISHES, wishes);
        renderAll();
        closeWishModal();
        showToast("å¿ƒæ„¿å·²åŠ å…¥", "èƒ–æ¬£æ¬£ï¼šæ”¶åˆ°ï¼å·²åŠ å…¥å¾…åŠæ¸…å•ã€‚");
      }else{
        const w = wishes.find(x => x.id === editingWishId);
        if (!w) return;
        w.title = title;
        w.desc = desc;
        w.updatedAt = Date.now();
        saveLS(LS_WISHES, wishes);
        renderAll();
        closeWishModal();
        showToast("å·²ä¿å­˜", "å¿ƒæ„¿æ›´æ–°å®Œæˆã€‚");
      }
    }

    // ===== Confirm Order (Local + Formspree) =====
    async function confirmOrder(){
      const selected = dishes.filter(d => d.selected);
      if (!selected.length && !wishes.length){
        showToast("è¿˜ä¸èƒ½ä¸‹å•", "è‡³å°‘é€‰ä¸€é“èœæˆ–å†™ä¸€ä¸ªå¿ƒæ„¿ï½");
        return;
      }

      // Save order locally
      const now = new Date();
      const order = {
        id: crypto.randomUUID(),
        createdAt: now.toISOString(),
        createdAtLocal: now.toLocaleString(),
        title: "èƒ–æ¬£æ¬£ & ç˜¦åª›åª›çš„ä¸“å±æƒ…äººèŠ‚",
        selectedDishes: selected.map(d => ({
          cuisine: d.cuisine, name: d.name, price: d.price || "", tags: d.tags || "", note: d.note || ""
        })),
        wishes: wishes.map(w => ({ title: w.title, desc: w.desc || "" })),
        yourEmailHint: (emailHintEl.value || "").trim()
      };

      const history = loadLS(LS_ORDERS) || [];
      history.unshift(order);
      saveLS(LS_ORDERS, history);

      // Send email via Formspree
      const endpoint = (endpointEl.value || "").trim();
      if (!endpoint){
        showToast("å·²ä¿å­˜åˆ°æœ¬åœ° âœ…", "æœªå¡«å†™ Formspree endpointï¼Œå› æ­¤æœªå‘é€é‚®ä»¶ã€‚");
        return;
      }

      showToast("æ­£åœ¨å‘é€é‚®ä»¶â€¦", "çˆ±æƒ…æ­£åœ¨è·¯ä¸Šï¼ˆå¦‚æœå¤±è´¥ä¹Ÿå·²ä¿å­˜æœ¬åœ°ï¼‰ã€‚");

      try{
        const text = buildOrderEmailText(order);

        // Formspree accepts JSON (with Accept: application/json)
        const resp = await fetch(endpoint, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Accept": "application/json"
          },
          body: JSON.stringify({
            subject: "ğŸ’Œ æƒ…äººèŠ‚ä¸‹å•é€šçŸ¥ï½œèƒ–æ¬£æ¬£ & ç˜¦åª›åª›",
            message: text,
            your_email: order.yourEmailHint || "",
            created_at: order.createdAtLocal
          })
        });

        if (!resp.ok){
          const t = await safeReadText(resp);
          throw new Error(`å‘é€å¤±è´¥ï¼šHTTP ${resp.status} ${resp.statusText}${t ? " / " + t : ""}`);
        }

        showToast("å‘é€æˆåŠŸ âœ…", "é‚®ä»¶å·²å‘å‡ºï¼šèƒ–æ¬£æ¬£æ”¶åˆ°è®¢å•ï¼Œå‡†å¤‡ä¸Šèœï¼ˆå’Œä¹°å•ï¼‰ã€‚");
      }catch(e){
        showToast("é‚®ä»¶å‘é€å¤±è´¥", (e?.message || String(e)) + "ï¼ˆä½†è®¢å•å·²ä¿å­˜åˆ°æœ¬åœ°ï¼‰");
      }
    }

    function buildOrderEmailText(order){
      const lines = [];
      lines.push("èƒ–æ¬£æ¬£ & ç˜¦åª›åª›çš„ä¸“å±æƒ…äººèŠ‚ï½œä¸‹å•é€šçŸ¥");
      lines.push("â€”");
      lines.push(`ä¸‹å•æ—¶é—´ï¼š${order.createdAtLocal}`);
      if (order.yourEmailHint) lines.push(`ä¸‹å•äººé‚®ç®±(å¤‡æ³¨)ï¼š${order.yourEmailHint}`);
      lines.push("");

      lines.push("å·²é€‰èœå•ï¼š");
      if (order.selectedDishes.length){
        order.selectedDishes.forEach((d, i) => {
          lines.push(`${i+1}. ${d.cuisine}ï½œ${d.name}${d.price ? `ï¼ˆÂ¥${d.price}ï¼‰` : ""}${d.tags ? `ï½œ${d.tags}` : ""}`);
          if (d.note) lines.push(`   å¤‡æ³¨ï¼š${d.note}`);
        });
      }else{
        lines.push("ï¼ˆæœªé€‰æ‹©èœå“ï¼‰");
      }

      lines.push("");
      lines.push("å¿ƒæ„¿æ¸…å•ï¼š");
      if (order.wishes.length){
        order.wishes.forEach((w, i) => {
          lines.push(`${i+1}. ${w.title}`);
          if (w.desc) lines.push(`   æè¿°ï¼š${w.desc}`);
        });
      }else{
        lines.push("ï¼ˆæ— å¿ƒæ„¿ï¼‰");
      }

      lines.push("");
      lines.push("ä¿çš®å¤‡æ³¨ï¼š");
      lines.push("â€œç˜¦åª›åª›è´Ÿè´£ç‚¹é¤ï¼Œèƒ–æ¬£æ¬£è´Ÿè´£æ¸…ç›˜ï¼ˆå’Œä¹°å•ï¼‰ã€‚â€");
      lines.push("â€œç‚¹å‡»ç¡®è®¤ä¸‹å•ï¼Œçˆ±æƒ…å³åˆ»é€è¾¾ã€‚â€");

      return lines.join("\n");
    }

    async function safeReadText(resp){
      try{ return (await resp.text()).slice(0, 200); }catch{ return ""; }
    }

    // ===== Toast =====
    function showToast(title, msg){
      toastTitle.textContent = title;
      toastMsg.textContent = msg;
      toast.classList.add("show");
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => toast.classList.remove("show"), 4200);
    }

    // ===== LocalStorage helpers =====
    function loadLS(key){
      try{
        const raw = localStorage.getItem(key);
        return raw ? JSON.parse(raw) : null;
      }catch{
        return null;
      }
    }
    function saveLS(key, val){
      localStorage.setItem(key, JSON.stringify(val));
    }

    // ===== Debounce =====
    function debounce(fn, waitMs){
      let t = null;
      return (...args) => {
        clearTimeout(t);
        t = setTimeout(() => fn(...args), waitMs);
      };
    }

    // ===== IndexedDB (HD image blobs) =====
    function openDB(){
      return new Promise((resolve, reject) => {
        const req = indexedDB.open(DB_NAME, 1);
        req.onupgradeneeded = () => {
          const db = req.result;
          if (!db.objectStoreNames.contains(STORE)){
            db.createObjectStore(STORE);
          }
        };
        req.onsuccess = () => resolve(req.result);
        req.onerror = () => reject(req.error);
      });
    }

    async function idbSet(key, blob){
      const db = await openDB();
      return new Promise((resolve, reject) => {
        const tx = db.transaction(STORE, "readwrite");
        tx.objectStore(STORE).put(blob, key);
        tx.oncomplete = () => resolve(true);
        tx.onerror = () => reject(tx.error);
      });
    }

    async function idbGet(key){
      const db = await openDB();
      return new Promise((resolve, reject) => {
        const tx = db.transaction(STORE, "readonly");
        const req = tx.objectStore(STORE).get(key);
        req.onsuccess = () => resolve(req.result || null);
        req.onerror = () => reject(req.error);
      });
    }

    async function idbClearAll(){
      const db = await openDB();
      return new Promise((resolve, reject) => {
        const tx = db.transaction(STORE, "readwrite");
        tx.objectStore(STORE).clear();
        tx.oncomplete = () => resolve(true);
        tx.onerror = () => reject(tx.error);
      });
    }

    // Thumbnail generator: small, stored in LocalStorage for fast render
    async function makeThumbnailDataUrl(file, maxW=900, quality=0.86){
      const bmp = await createImageBitmap(file);
      const scale = Math.min(1, maxW / bmp.width);
      const w = Math.max(1, Math.round(bmp.width * scale));
      const h = Math.max(1, Math.round(bmp.height * scale));

      const canvas = document.createElement("canvas");
      canvas.width = w;
      canvas.height = h;
      const ctx = canvas.getContext("2d", {alpha:false});
      ctx.imageSmoothingEnabled = true;
      ctx.imageSmoothingQuality = "high";
      ctx.drawImage(bmp, 0, 0, w, h);

      // Prefer WebP; fallback JPEG
      let type = "image/webp";
      let url = canvas.toDataURL(type, quality);
      if (!url.startsWith("data:image/webp")){
        type = "image/jpeg";
        url = canvas.toDataURL(type, quality);
      }
      return url;
    }

    // Full image preview
    async function showFullImage(blobKey, title){
      const blob = await idbGet(blobKey);
      if (!blob){
        showToast("æ‰¾ä¸åˆ°åŸå›¾", "å¯èƒ½è¢«æµè§ˆå™¨æ¸…ç†è¿‡ï¼Œè¯·é‡æ–°ä¸Šä¼ ã€‚");
        return;
      }
      const url = URL.createObjectURL(blob);
      imgModalTitle.textContent = title || "é«˜æ¸…é¢„è§ˆ";
      imgModalImg.src = url;
      imgModal.dataset.url = url;
      imgModal.classList.add("show");
    }

    function closeImgModal(){
      imgModal.classList.remove("show");
      const url = imgModal.dataset.url;
      if (url) URL.revokeObjectURL(url);
      imgModal.dataset.url = "";
      imgModalImg.src = "";
    }
  </script>
</body>
</html>

                        <!DOCTYPE html>
                        <html lang="en">
                        <head>
                            <meta charset="UTF-8">
                            <meta name="viewport" content="width=device-width, initial-scale=1.0">
							<style>
								body {
									background-color: white; /* Ensure the iframe has a white background */
								}

								/* é€šç”¨æ ·å¼ */
body {
    /* å¼•å…¥ Google Fonts: Noto Sans SC ç”¨äºæ­£æ–‡ï¼ŒDancing Script ç”¨äºæ ‡é¢˜ */
    font-family: 'Noto Sans SC', sans-serif;
    margin: 0;
    padding: 0;
    background-color: #FDF8F5; /* æŸ”å’Œçš„æš–ç±³è‰²èƒŒæ™¯ */
    color: #333333; /* æ·±ç°è‰²æ–‡å­— */
    line-height: 1.6;
    scroll-behavior: smooth; /* å¹³æ»‘æ»šåŠ¨æ•ˆæœ */
}

.container {
    max-width: 1200px; /* é¡µé¢æœ€å¤§å®½åº¦ */
    margin: 30px auto; /* å±…ä¸­æ˜¾ç¤ºï¼Œä¸Šä¸‹æ›´å¤šå¤–è¾¹è· */
    padding: 0 25px; /* å·¦å³å†…è¾¹è· */
}

/* å¤´éƒ¨æ ·å¼ */
.site-header {
    background-color: #FF6B8B; /* æŸ”å’Œçš„ç«ç‘°ç²‰ */
    color: white;
    text-align: center;
    padding: 50px 20px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* åº•éƒ¨æŸ”å’Œé˜´å½± */
}

.site-header h1 {
    font-family: 'Dancing Script', cursive; /* ä¸ªæ€§åŒ–æ‰‹å†™å­—ä½“ */
    margin: 0 0 10px;
    font-size: 3.5em; /* æ ‡é¢˜æ›´å¤§ */
    letter-spacing: 2px; /* å¢åŠ å­—é—´è· */
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2); /* è½»å¾®æ–‡å­—é˜´å½± */
}

.site-header p {
    font-size: 1.2em;
    opacity: 0.9;
    font-weight: 300; /* å­—ä½“æ›´ç»† */
}

/* å…¨æ–° Banner æ ·å¼ - å¸¦åŠ¨ç”» */
.banner-section {
    background-color: #FF6B8B; /* é»˜è®¤èƒŒæ™¯è‰² */
    color: white;
    text-align: center;
    padding: 100px 20px; /* æ›´å¤šå†…è¾¹è· */
    margin-bottom: 40px;
    position: relative;
    overflow: hidden;
    box-shadow: 0 8px 20px rgba(0,0,0,0.15); /* æ›´æ˜æ˜¾çš„é˜´å½± */
}

.banner-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    /* æµåŠ¨çš„æ¸å˜èƒŒæ™¯ */
    background: linear-gradient(135deg,
        #FFD1AA 0%,   /* æš–æ¡ƒè‰² */
        #FFADCB 25%,  /* æ·¡ç²‰è‰² */
        #FFD1AA 50%,
        #FFADCB 75%,
        #FFD1AA 100%
    );
    background-size: 400% 400%; /* ä½¿æ¸å˜è¶³å¤Ÿå¤§ä»¥ä¾¿ç§»åŠ¨ */
    animation: gradientAnimation 18s ease infinite alternate; /* 18s åŠ¨ç”»ï¼Œç¼“åŠ¨ï¼Œæ— é™é‡å¤ï¼Œæ¥å›æ’­æ”¾ */
    z-index: 1; /* åœ¨å†…å®¹ä¸‹æ–¹ */
    opacity: 0.8; /* ç¨é€æ˜ */
}

@keyframes gradientAnimation {
    0% { background-position: 0% 0%; }
    100% { background-position: 100% 100%; }
}

.banner-content {
    position: relative;
    z-index: 2;
    max-width: 900px;
    margin: 0 auto;
}

/* Banner æ–‡å­—åŠ¨ç”» */
.banner-content h2,
.banner-content p,
.banner-btn {
    opacity: 0; /* åˆå§‹çŠ¶æ€ä¸ºé€æ˜ */
    transform: translateY(20px); /* åˆå§‹çŠ¶æ€ç¨å¾®å‘ä¸‹åç§» */
    animation-fill-mode: forwards; /* åŠ¨ç”»ç»“æŸåä¿æŒæœ€ç»ˆçŠ¶æ€ */
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.4); /* æ–‡å­—é˜´å½±ï¼Œçªå‡ºæ˜¾ç¤º */
}

.banner-content h2 {
    font-size: 3.2em;
    margin-bottom: 20px;
    animation: fadeInSlideUp 1s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.5s forwards; /* æ›²çº¿ç¼“åŠ¨ */
}

.banner-content p {
    font-size: 1.5em;
    margin-bottom: 40px;
    animation: fadeInSlideUp 1s cubic-bezier(0.25, 0.46, 0.45, 0.94) 1s forwards;
}

.banner-btn {
    animation: fadeInSlideUp 1s cubic-bezier(0.25, 0.46, 0.45, 0.94) 1.5s forwards;
}

@keyframes fadeInSlideUp {
    0% {
        opacity: 0;
        transform: translateY(30px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

.banner-btn {
    background-color: #FF6B8B; /* ä¸å¤´éƒ¨é¢œè‰²ä¸€è‡´ */
    color: white;
    padding: 14px 30px;
    border-radius: 30px; /* æ›´åœ†æ¶¦çš„æŒ‰é’® */
    font-size: 1.1em;
    font-weight: bold;
    text-decoration: none;
    margin: 0 15px;
    transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.banner-btn:hover {
    background-color: #E65A7A; /* é¼ æ ‡æ‚¬åœæ—¶é¢œè‰²å˜æ·± */
    transform: translateY(-5px); /* å‘ä¸Šæµ®åŠ¨æ›´å¤š */
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
}


/* ç« èŠ‚é€šç”¨æ ·å¼ */
section {
    background-color: #fff; /* ç™½è‰²èƒŒæ™¯ */
    border-radius: 15px; /* æ›´å¤§çš„åœ†è§’ */
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08); /* æŸ”å’Œé˜´å½± */
    margin-bottom: 40px;
    padding: 35px;
}

section h2 {
    font-family: 'Noto Sans SC', sans-serif;
    color: #333333;
    text-align: center;
    margin-bottom: 35px;
    font-size: 2.5em;
    position: relative;
    padding-bottom: 15px;
    letter-spacing: 1px;
    font-weight: 700;
}

section h2::after {
    content: '';
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    bottom: 0;
    width: 80px;
    height: 5px;
    background-color: #FFD1AA; /* æŸ”å’Œçš„æ¡ƒè‰²ä¸‹åˆ’çº¿ */
    border-radius: 3px;
}

/* èœå•å’Œå¿ƒæ„¿æ¸…å•ç½‘æ ¼å¸ƒå±€ */
.menu-grid, .wishlist-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* å“åº”å¼ç½‘æ ¼ï¼Œé€‚åº”æ›´å°çš„å¡ç‰‡ */
    gap: 30px; /* ç½‘æ ¼é—´è· */
}

/* èœå•é¡¹å’Œå¿ƒæ„¿é¡¹é€šç”¨æ ·å¼ */
.menu-item, .wishlist-item {
    border: none; /* ç§»é™¤é»˜è®¤è¾¹æ¡† */
    border-radius: 15px; /* æ›´å¤§çš„åœ†è§’ */
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    background-color: #fff;
    display: flex;
    flex-direction: column;
    position: relative;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08); /* åˆå§‹æŸ”å’Œé˜´å½± */
}

.menu-item:hover, .wishlist-item:hover {
    transform: translateY(-10px); /* å‘ä¸Šæµ®åŠ¨æ›´å¤š */
    box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15); /* æ›´æ˜æ˜¾çš„é˜´å½± */
}

.menu-item img, .wishlist-item img {
    width: 100%;
    height: 220px; /* å›¾ç‰‡é«˜åº¦å¢åŠ  */
    object-fit: cover;
    display: block;
    border-bottom: 1px solid #f0f0f0; /* æµ…è‰²åˆ†éš”çº¿ */
}

.menu-item h3, .wishlist-item h3 {
    margin: 18px 20px 8px;
    font-size: 1.6em;
    color: #333333;
    font-weight: 700;
}

.menu-item p, .wishlist-item p {
    margin: 0 20px 18px;
    font-size: 1em;
    color: #666666;
    flex-grow: 1;
    line-height: 1.5;
}

.menu-item .price {
    display: block;
    text-align: right;
    font-size: 1.5em;
    font-weight: bold;
    color: #FF6B8B; /* é†’ç›®ç«ç‘°ç²‰ä»·æ ¼ */
    padding: 12px 20px 18px;
    border-top: 1px solid #f0f0f0;
}

/* èœå•ç‚¹èœæŒ‰é’® */
.select-menu-btn {
    background-color: #66BB6A; /* æŸ”å’Œç»¿è‰² */
    color: white;
    padding: 12px 20px;
    border: none;
    border-radius: 8px; /* ç¨åœ†æ¶¦çš„æŒ‰é’® */
    cursor: pointer;
    font-size: 1.05em;
    font-weight: bold;
    transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
    margin: 0 20px 20px auto;
    display: block;
    width: fit-content;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.select-menu-btn:hover {
    background-color: #4CAF50; /* æ‚¬åœæ—¶æ›´æ·±çš„ç»¿è‰² */
    transform: translateY(-3px);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

/* èœå•ä»‹ç»å’Œæ·»åŠ æŒ‰é’®å®¹å™¨ */
.menu-intro, .wishlist-intro {
    text-align: center;
    font-size: 1.15em;
    color: #555;
    margin-bottom: 30px;
    line-height: 1.5;
}
.add-menu-item-container, .add-wish-container {
    text-align: center;
    margin-bottom: 30px;
}
.add-menu-item-btn {
    background-color: #FFD1AA; /* æ¡ƒè‰²æ·»åŠ æŒ‰é’® */
    color: #333333;
    padding: 14px 30px;
    font-size: 1.1em;
    font-weight: bold;
    border-radius: 30px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}
.add-menu-item-btn:hover {
    background-color: #FFC099; /* æ‚¬åœæ—¶é¢œè‰²å˜æ·± */
    transform: translateY(-3px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.15);
}

/* æˆ‘çš„è®¢å•åŒºæ ·å¼ */
.order-section {
    background-color: #FFF7EC; /* æµ…ç±³è‰²èƒŒæ™¯ï¼Œä¸ä¸»è‰²è°ƒåè°ƒ */
    border-radius: 15px;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
    margin-bottom: 40px;
    padding: 35px;
}

.order-section h2 {
    color: #FF8A65; /* æŸ”å’Œçš„æ©™è‰²æ ‡é¢˜ */
    position: relative;
}
.order-section h2::after {
    background-color: #FF8A65;
}

#order-summary-list {
    margin-top: 25px;
    margin-bottom: 25px;
    border-top: 1px dashed #e0e0e0;
    padding-top: 20px;
}

.order-list-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px dotted #eeeeee;
    font-size: 1.1em;
    color: #555;
    flex-wrap: wrap;
}

.order-list-item:last-child {
    border-bottom: none;
}

.order-item-details {
    display: flex;
    align-items: center;
    gap: 15px;
    flex-grow: 1;
    flex-wrap: wrap;
}

.order-item-price-actions {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-left: auto;
    flex-shrink: 0;
    font-weight: bold;
    color: #FF6B8B;
}

/* æ•°é‡æ§åˆ¶æŒ‰é’®å’Œè¾“å…¥æ¡† */
.qty-controls {
    display: flex;
    align-items: center;
    gap: 5px;
    margin-left: 10px;
}

.btn-qty {
    background-color: #B0BEC5; /* æŸ”å’Œçš„è“ç°è‰² */
    color: white;
    padding: 6px 10px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1em;
    width: 32px;
    height: 32px;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: background-color 0.3s ease;
}

.btn-qty:hover {
    background-color: #90A4AE;
}

/* æ•°é‡è¾“å…¥æ¡†æ ·å¼ */
.item-qty-input {
    width: 45px; /* å®½åº¦å¢åŠ  */
    text-align: center;
    border: 1px solid #E0E0E0; /* æŸ”å’Œè¾¹æ¡† */
    border-radius: 5px;
    padding: 6px 0; /* å¡«å……å¢åŠ  */
    font-weight: bold;
    color: #333333;
    font-size: 1em;
    -moz-appearance: textfield; /* éšè— Firefox çš„é»˜è®¤ä¸Šä¸‹ç®­å¤´ */
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
}
/* éšè— Chrome, Safari, Edge çš„é»˜è®¤ä¸Šä¸‹ç®­å¤´ */
.item-qty-input::-webkit-outer-spin-button,
.item-qty-input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}
.item-qty-input:focus {
    border-color: #64B5F6; /* èšç„¦æ—¶è“è‰²è¾¹æ¡† */
    outline: none;
    box-shadow: 0 0 0 2px rgba(100, 181, 246, 0.2); /* èšç„¦æ—¶è“è‰²é˜´å½± */
    background-color: #F8FCFF; /* èšç„¦æ—¶æµ…è‰²èƒŒæ™¯ */
}


.btn-small {
    padding: 6px 12px;
    font-size: 0.9em;
    border-radius: 5px;
    background-color: #B0BEC5; /* å°æŒ‰é’®é¢œè‰² */
}

.btn-small:hover {
    background-color: #90A4AE;
}

.order-total-area {
    text-align: right;
    font-size: 1.8em;
    font-weight: bold;
    color: #FF6B8B; /* æ€»è®¡é¢œè‰² */
    margin-top: 30px;
    padding-top: 15px;
    border-top: 2px solid #FFD1AA; /* æŸ”å’Œçš„æ¡ƒè‰²è¾¹æ¡† */
}

.order-actions {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 35px;
    flex-wrap: wrap;
}

.confirm-order-btn {
    background-color: #66BB6A; /* æŸ”å’Œç»¿è‰²ç¡®è®¤æŒ‰é’® */
}
.confirm-order-btn:hover {
    background-color: #4CAF50;
}

.clear-order-btn {
    background-color: #EF5350; /* æŸ”å’Œçº¢è‰²æ¸…ç©ºæŒ‰é’® */
}
.clear-order-btn:hover {
    background-color: #D32F2F;
}

/* å¿ƒæ„¿æ¸…å•åŒºæ ·å¼ */
.wishlist-intro {
    text-align: center;
    font-size: 1.15em;
    color: #555;
    margin-bottom: 30px;
}

/* æ–°å¢å¿ƒæ„¿æŒ‰é’®æ ·å¼ */
.add-wish-btn {
    background-color: #FFD1AA; /* æ¡ƒè‰²ï¼Œä¸èœå•æ·»åŠ æŒ‰é’®åè°ƒ */
    color: #333333;
    padding: 14px 30px;
    font-size: 1.1em;
    font-weight: bold;
    border-radius: 30px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.add-wish-btn:hover {
    background-color: #FFC099;
    transform: translateY(-3px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.15);
}

.wishlist-item .status {
    text-align: right;
    font-size: 1.05em;
    font-weight: bold;
    padding: 12px 20px 18px;
    border-top: 1px solid #f0f0f0;
    margin-top: auto;
}

.wishlist-item .status.fulfilled {
    color: #4CAF50; /* è¾¾æˆå¿ƒæ„¿ä¸ºç»¿è‰² */
}

.wishlist-item .status.pending {
    color: #FFCC80; /* æœªè¾¾æˆå¿ƒæ„¿ä¸ºæŸ”å’Œæ©™è‰² */
}

/* ç¼–è¾‘æ¨¡å¼ä¸‹çš„æ ·å¼ */
.wishlist-item.editing, .menu-item.editing {
    border: 2px solid #64B5F6; /* ç¼–è¾‘æ—¶æŸ”å’Œè“è‰²è¾¹æ¡† */
    box-shadow: 0 8px 20px rgba(100, 181, 246, 0.3); /* æ›´æ˜æ˜¾çš„è“è‰²é˜´å½± */
}

/* å¯ç¼–è¾‘åŒºåŸŸçš„è§†è§‰æç¤º */
.wishlist-item h3[contenteditable="true"],
.wishlist-item p[contenteditable="true"],
.menu-item h3[contenteditable="true"],
.menu-item p[contenteditable="true"],
.menu-item .price[contenteditable="true"] {
    border: 1px dotted #ccc;
    padding: 3px 5px;
    border-radius: 5px;
    outline: none;
    background-color: #fcfcfc;
}

/* çŠ¶æ€é€‰æ‹©ä¸‹æ‹‰èœå• */
.status-select {
    width: auto;
    padding: 6px 10px;
    border-radius: 5px;
    border: 1px solid #ddd;
    font-size: 0.95em;
    margin-left: 10px;
    vertical-align: middle;
}

/* åŠ¨ä½œæŒ‰é’®å®¹å™¨ */
.item-actions {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    padding: 12px 20px 18px;
    border-top: 1px solid #f0f0f0;
    gap: 12px; /* æŒ‰é’®ä¹‹é—´é—´éš” */
    flex-wrap: wrap;
}

/* èœå•é¡¹çš„ actions æŒ‰é’®ï¼Œç‚¹èœæŒ‰é’®ä¼šå’Œå®ƒä»¬åœ¨åŒä¸€è¡Œ */
.menu-actions {
    justify-content: flex-start;
    padding-bottom: 0;
    border-bottom: none;
}

/* é€šç”¨æŒ‰é’®æ ·å¼ (åŸºç¡€æ ·å¼) */
.btn {
    background-color: #90A4AE; /* æŸ”å’Œçš„è“ç°è‰² */
    color: white;
    padding: 10px 18px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1em;
    transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    font-weight: 500;
}

.btn:hover {
    opacity: 0.95;
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
}

/* ç¼–è¾‘æŒ‰é’®ç‰¹å®šæ ·å¼ */
.edit-btn, .edit-menu-btn {
    background-color: #64B5F6; /* æŸ”å’Œè“è‰²ç¼–è¾‘æŒ‰é’® */
}
.edit-btn:hover, .edit-menu-btn:hover {
    background-color: #42A5F5;
}

/* ä¿å­˜æŒ‰é’®ç‰¹å®šæ ·å¼ */
.save-btn, .save-menu-btn {
    background-color: #66BB6A; /* æŸ”å’Œç»¿è‰²ä¿å­˜æŒ‰é’® */
}
.save-btn:hover, .save-menu-btn:hover {
    background-color: #4CAF50;
}

/* åˆ é™¤æŒ‰é’®ç‰¹å®šæ ·å¼ */
.delete-btn, .delete-menu-btn {
    background-color: #EF5350; /* æŸ”å’Œçº¢è‰²åˆ é™¤æŒ‰é’® */
}
.delete-btn:hover, .delete-menu-btn:hover {
    background-color: #D32F2F;
}

/* æ›´æ¢å›¾ç‰‡æŒ‰é’®æ ·å¼ (ä¸ä¸Šä¼ æ ‡ç­¾ç›¸åŒ, ä½†æ­¤å¤„ç”¨äºç¼–è¾‘æ¨¡å¼) */
.upload-label {
    display: inline-block;
    background-color: #FFCC80; /* æŸ”å’Œæ©™è‰² */
    color: #333333;
    padding: 10px 18px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1em;
    transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    font-weight: 500;
}

.upload-label:hover {
    background-color: #FFB74D; /* æ‚¬åœæ·±æ©™è‰² */
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
}

/* æ•°æ®ç®¡ç†æŒ‰é’®å®¹å™¨ */
.data-management {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 40px;
    padding-top: 25px;
    border-top: 1px dashed #e0e0e0;
    flex-wrap: wrap;
}

.export-btn {
    background-color: #90A4AE; /* å¯¼å‡ºæŒ‰é’® - æŸ”å’Œè“ç°è‰² */
}
.export-btn:hover {
    background-color: #78909C;
}

.import-label {
    background-color: #81D4FA; /* å¯¼å…¥æŒ‰é’® - æŸ”å’Œå¤©è“è‰² */
    color: #333333;
}
.import-label:hover {
    background-color: #4FC3F7;
}


/* åˆå§‹åŠ è½½å ä½ç¬¦ */
.initial-placeholder {
    grid-column: 1 / -1;
    text-align: center;
    padding: 60px 0;
    color: #999;
    font-style: italic;
    font-size: 1.1em;
}


/* æ³¨æ„äº‹é¡¹ */
.note {
    text-align: center;
    font-size: 0.9em;
    color: #777;
    margin-top: 50px;
    padding: 25px;
    background-color: #FFF7EC; /* æµ…ç±³è‰²èƒŒæ™¯ */
    border-radius: 12px;
    border-left: 6px solid #FFD1AA; /* æŸ”å’Œæ¡ƒè‰²å·¦ä¾§è¾¹æ¡† */
    line-height: 1.7;
    box-shadow: 0 3px 10px rgba(0,0,0,0.05);
}
.note strong {
    color: #FF8A65; /* å¼ºè°ƒæ–‡å­—é¢œè‰² */
}

/* åº•éƒ¨æ ·å¼ */
.site-footer {
    text-align: center;
    padding: 30px 20px;
    background-color: #333333;
    color: #cccccc;
    font-size: 0.95em;
    margin-top: 50px;
    box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.05);
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .site-header h1 {
        font-size: 2.5em;
    }
    section h2 {
        font-size: 2em;
        padding-bottom: 10px;
        margin-bottom: 25px;
    }
    section h2::after {
        width: 60px;
        height: 4px;
    }
    .menu-grid, .wishlist-grid {
        grid-template-columns: 1fr;
    }
    .container {
        margin: 20px auto;
        padding: 0 15px;
    }
    section {
        padding: 25px;
        margin-bottom: 30px;
    }
    .banner-section {
        padding: 70px 15px;
    }
    .banner-content h2 {
        font-size: 2.5em;
    }
    .banner-content p {
        font-size: 1.2em;
    }
    .banner-btn {
        display: block;
        width: 90%;
        margin: 15px auto;
        font-size: 1em;
        padding: 12px 25px;
    }
    .item-actions {
        flex-direction: column;
        align-items: stretch;
        padding: 15px 20px 20px;
    }
    .item-actions .btn, .item-actions .upload-label {
        width: 100%;
        text-align: center;
        margin-bottom: 8px;
    }
    .order-actions, .data-management {
        flex-direction: column;
    }
    .order-actions .btn, .data-management .btn, .data-management .import-label {
        width: 100%;
        margin-bottom: 12px;
    }
    .order-list-item {
        flex-direction: column;
        align-items: flex-start;
    }
    .order-item-details, .order-item-price-actions {
        width: 100%;
        margin-left: 0;
        justify-content: space-between;
        margin-bottom: 8px;
    }
    .order-item-price-actions > span {
        margin-right: auto;
    }
    .menu-item img, .wishlist-item img {
        height: 180px; /* å‡å°å›¾ç‰‡é«˜åº¦ */
    }
    .item-qty-input {
        width: 40px; /* å°å±å¹•ä¸‹è¾“å…¥æ¡†å®½åº¦ */
        padding: 5px 0;
    }
    .btn-qty {
        width: 28px;
        height: 28px;
        padding: 4px 8px;
    }
}

@media (max-width: 480px) {
    .site-header {
        padding: 35px 15px;
    }
    .site-header h1 {
        font-size: 2em;
    }
    .site-header p {
        font-size: 1em;
    }
    section h2 {
        font-size: 1.8em;
    }
    .add-wish-btn, .select-menu-btn, .add-menu-item-btn {
        font-size: 0.95em;
        padding: 10px 20px;
    }
    .menu-item h3, .wishlist-item h3 {
        font-size: 1.4em;
    }
    .menu-item p, .wishlist-item p {
        font-size: 0.9em;
    }
    .menu-item .price {
        font-size: 1.3em;
    }
    .order-total-area {
        font-size: 1.5em;
    }
}
							</style>
                        </head>
                        <body>
                            <!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èƒ–æ¬£æ¬£ç˜¦åª›åª›å®¶åº­å‘µæŠ¤ç½‘</title>
    <!-- å¼•å…¥ Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
    <!-- å¼•å…¥å¤–éƒ¨CSSæ–‡ä»¶ -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="site-header">
        <h1>èƒ–æ¬£æ¬£ç˜¦åª›åª›å®¶åº­å‘µæŠ¤ç½‘</h1>
        <p>ä¸“å±ä½ å’Œå¥¹çš„èœå•ä¸å¿ƒæ„¿æ¸…å•</p>
    </header>

    <!-- å…¨æ–° Banner éƒ¨åˆ† -->
    <section class="banner-section">
        <div class="banner-content">
            <h2>æˆ‘ä»¬çš„å°ç¡®å¹¸ï¼Œä»è¿™é‡Œå¼€å§‹</h2>
            <p>ç²¾å¿ƒä¸ºæ‚¨å‡†å¤‡çš„ç¾å‘³ï¼Œå’Œæˆ‘ä»¬å…±åŒæœŸå¾…çš„æœªæ¥</p>
            <a href="#menu-grid-section" class="btn banner-btn">æŸ¥çœ‹èœå•</a>
            <a href="#wishlist-grid-section" class="btn banner-btn">æŸ¥çœ‹å¿ƒæ„¿</a>
        </div>
    </section>

    <main class="container">
        <!-- èœå•éƒ¨åˆ† -->
        <section class="menu-section" id="menu-grid-section">
            <h2>ç¾å‘³èœå•</h2>
            <p class="menu-intro">åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥ä¸ºå¥¹å‡†å¤‡å’Œè°ƒæ•´èœå•ã€‚</p>
            <div class="add-menu-item-container">
                <button class="btn add-menu-item-btn">æ·»åŠ æ–°èœå“</button>
            </div>
            <div class="menu-grid" id="menu-grid">
                <!-- èœå•é¡¹å°†ç”±JavaScriptåŠ¨æ€åŠ è½½å’Œæ¸²æŸ“ -->
                <div class="initial-placeholder">
                    <p>æ­£åœ¨åŠ è½½èœå•...</p>
                </div>
            </div>
            <!-- èœå•å¯¼å…¥/å¯¼å‡ºæŒ‰é’® -->
            <div class="data-management">
                <button class="btn export-btn" id="export-menu-btn">å¯¼å‡ºèœå•</button>
                <label for="import-menu-file" class="btn import-label">å¯¼å…¥èœå•</label>
                <input type="file" id="import-menu-file" accept=".json" style="display: none;">
            </div>
        </section>

        <!-- æˆ‘çš„è®¢å•éƒ¨åˆ† -->
        <section class="order-section">
            <h2>æˆ‘çš„è®¢å•</h2>
            <div id="order-summary-list">
                <!-- è®¢å•åˆ—è¡¨å°†ç”±JavaScriptåŠ¨æ€åŠ è½½å’Œæ¸²æŸ“ -->
                <p>æš‚æ— å·²ç‚¹èœå“ã€‚</p>
            </div>
            <div class="order-total-area">
                <span>æ€»è®¡ï¼š</span><span id="order-total">Â¥ 0.00</span>
            </div>
            <div class="order-actions">
                <button class="btn confirm-order-btn">ç¡®è®¤è®¢å•</button>
                <button class="btn clear-order-btn">æ¸…ç©ºè®¢å•</button>
            </div>
            <!-- è®¢å•å¯¼å…¥/å¯¼å‡ºæŒ‰é’® -->
            <div class="data-management">
                <button class="btn export-btn" id="export-order-btn">å¯¼å‡ºè®¢å•</button>
                <label for="import-order-file" class="btn import-label">å¯¼å…¥è®¢å•</label>
                <input type="file" id="import-order-file" accept=".json" style="display: none;">
            </div>
        </section>

        <!-- å¿ƒæ„¿æ¸…å•éƒ¨åˆ† -->
        <section class="wishlist-section" id="wishlist-grid-section">
            <h2>å¿ƒæ„¿æ¸…å•</h2>
            <p class="wishlist-intro">è¿™äº›æ˜¯æˆ‘ä»¬å…±åŒæœŸå¾…çš„å¿ƒæ„¿ï¼ŒåŠªåŠ›è®©å®ƒä»¬ä¸€ä¸€å®ç°ï¼</p>
            <!-- æ–°å¢å¿ƒæ„¿æŒ‰é’® -->
            <div class="add-wish-container">
                <button class="btn add-wish-btn">æ·»åŠ æ–°å¿ƒæ„¿</button>
            </div>
            <div class="wishlist-grid" id="wishlist-grid">
                <!-- å¿ƒæ„¿é¡¹å°†ç”±JavaScriptåŠ¨æ€åŠ è½½å’Œæ¸²æŸ“ -->
                <div class="initial-placeholder">
                    <p>æ­£åœ¨åŠ è½½å¿ƒæ„¿æ¸…å•...</p>
                </div>
            </div>
            <!-- å¿ƒæ„¿æ¸…å•å¯¼å…¥/å¯¼å‡ºæŒ‰é’® -->
            <div class="data-management">
                <button class="btn export-btn" id="export-wishlist-btn">å¯¼å‡ºå¿ƒæ„¿æ¸…å•</button>
                <label for="import-wishlist-file" class="btn import-label">å¯¼å…¥å¿ƒæ„¿æ¸…å•</label>
                <input type="file" id="import-wishlist-file" accept=".json" style="display: none;">
            </div>
            <p class="note">
                <strong>é‡è¦æç¤ºï¼š</strong>æ­¤é¡µé¢æ‰€æœ‰æ•°æ®ï¼ˆèœå•ã€è®¢å•ã€å¿ƒæ„¿æ¸…å•ï¼‰å‡å·²ä¿å­˜åˆ°æ‚¨**å½“å‰æµè§ˆå™¨**çš„æœ¬åœ°å­˜å‚¨ä¸­ã€‚<br>
                å…³é—­æµè§ˆå™¨æˆ–åˆ·æ–°é¡µé¢åæ•°æ®å°†ä¿ç•™ã€‚ä½†è‹¥æ‚¨æ¸…é™¤æµè§ˆå™¨æ•°æ®ã€æ›´æ¢æµè§ˆå™¨æˆ–è®¾å¤‡ï¼Œè¿™äº›æ•°æ®å°†ä¸¢å¤±ã€‚<br>
                **å¤šè®¾å¤‡åŒæ­¥ï¼š** æ‚¨å¯ä»¥é€šè¿‡**å¯¼å‡º**åŠŸèƒ½ä¿å­˜å½“å‰æ•°æ®ï¼Œç„¶åå°†å¯¼å‡ºçš„JSONæ–‡ä»¶ä¼ è¾“åˆ°å¦ä¸€å°è®¾å¤‡ï¼Œå†é€šè¿‡**å¯¼å…¥**åŠŸèƒ½è½½å…¥æ•°æ®ï¼Œä»¥å®ç°**æ‰‹åŠ¨åŒæ­¥**ã€‚<br>
                **è®¢å•é€šçŸ¥ï¼š** æœ¬é¡µé¢ä¸ºçº¯å‰ç«¯å®ç°ï¼Œå½“æ‚¨ç¡®è®¤è®¢å•æ—¶ï¼Œè®¢å•æ•°æ®ä¼šåœ¨æµè§ˆå™¨æ§åˆ¶å° (F12 æ‰“å¼€å¼€å‘è€…å·¥å…·æŸ¥çœ‹) ä¸­æ‰“å°ï¼ŒåŒæ—¶ä¼šå°è¯•é€šè¿‡ `mailto:` åè®®æ‰“å¼€é‚®ä»¶å®¢æˆ·ç«¯å‘é€é€šçŸ¥ã€‚è¯·æ³¨æ„ `mailto:` éœ€è¦ç”¨æˆ·æ‰‹åŠ¨ç¡®è®¤å‘é€ï¼Œä¸”å¯èƒ½å—æµè§ˆå™¨å’Œå®¢æˆ·ç«¯é™åˆ¶ã€‚è‹¥éœ€è‡ªåŠ¨é€šçŸ¥ï¼Œéœ€è¦åç«¯æœåŠ¡å™¨å’Œæ•°æ®åº“æ”¯æŒã€‚
            </p>
        </section>
    </main>

    <footer class="site-footer">
        <p>&copy; 2023 èƒ–æ¬£æ¬£ç˜¦åª›åª›å®¶åº­å‘µæŠ¤ç½‘. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const menuGrid = document.getElementById('menu-grid');
            const addMenuItemBtn = document.querySelector('.add-menu-item-btn');
            const orderSummaryList = document.getElementById('order-summary-list');
            const orderTotalSpan = document.getElementById('order-total');
            const confirmOrderBtn = document.querySelector('.confirm-order-btn');
            const clearOrderBtn = document.querySelector('.clear-order-btn');

            const wishlistGrid = document.getElementById('wishlist-grid');
            const addWishBtn = document.querySelector('.add-wish-btn');

            // å¯¼å…¥å¯¼å‡ºæŒ‰é’®
            const exportMenuBtn = document.getElementById('export-menu-btn');
            const importMenuFile = document.getElementById('import-menu-file');
            const exportOrderBtn = document.getElementById('export-order-btn');
            const importOrderFile = document.getElementById('import-order-file');
            const exportWishlistBtn = document.getElementById('export-wishlist-btn');
            const importWishlistFile = document.getElementById('import-wishlist-file');

            let menuItems = []; // å­˜å‚¨æ‰€æœ‰èœå•é¡¹çš„æ•°ç»„
            let wishlistItems = []; // å­˜å‚¨æ‰€æœ‰å¿ƒæ„¿æ¸…å•é¡¹çš„æ•°ç»„
            let selectedOrder = []; // å­˜å‚¨å·²ç‚¹èœå•é¡¹çš„æ•°ç»„

            // ========================= é€šç”¨æ•°æ®æ“ä½œå‡½æ•° =========================
            function saveToLocalStorage(key, data) {
                localStorage.setItem(key, JSON.stringify(data));
            }

            function loadFromLocalStorage(key, defaultData) {
                const storedData = localStorage.getItem(key);
                return storedData ? JSON.parse(storedData) : defaultData;
            }

            // ========================= èœå•ç®¡ç†ç›¸å…³å‡½æ•° =========================
            function loadMenu() {
                // å¦‚æœ localStorage ä¸ºç©ºï¼Œä½¿ç”¨é¢„è®¾çš„åˆå§‹æ•°æ®
                const defaultMenuItems = [
                    // ä¸­é¤
                    {
                        id: 'menu-cn-1',
                        imageSrc: 'https://via.placeholder.com/300x200?text=å®«ä¿é¸¡ä¸',
                        title: 'å®«ä¿é¸¡ä¸',
                        description: 'ç»å…¸å·èœï¼Œé¦™è¾£å¯å£ï¼Œé¸¡è‚‰ä¸ä¸èŠ±ç”Ÿã€è¾£æ¤’çš„å®Œç¾ç»“åˆã€‚',
                        price: 78.00
                    },
                    {
                        id: 'menu-cn-2',
                        imageSrc: 'https://via.placeholder.com/300x200?text=éº»å©†è±†è…',
                        title: 'éº»å©†è±†è…',
                        description: 'å®¶å¸¸å·èœï¼Œéº»è¾£é²œé¦™ï¼Œè±†è…ç»†å«©ï¼Œå¼€èƒƒä¸‹é¥­ã€‚',
                        price: 58.00
                    },
                    {
                        id: 'menu-cn-3',
                        imageSrc: 'https://via.placeholder.com/300x200?text=æ‰¬å·ç‚’é¥­',
                        title: 'æ‰¬å·ç‚’é¥­',
                        description: 'ç²’ç²’åˆ†æ˜ï¼Œé…æ–™ä¸°å¯Œï¼Œè›‹é¦™ç±³é¦™äº¤ç»‡ï¼Œè€å°‘çš†å®œã€‚',
                        price: 45.00
                    },
                    {
                        id: 'menu-cn-4',
                        imageSrc: 'https://via.placeholder.com/300x200?text=å°ç¬¼åŒ…',
                        title: 'ä¸Šæµ·å°ç¬¼åŒ…',
                        description: 'çš®è–„é¦…å¤§ï¼Œæ±¤æ±é²œç¾ï¼Œä¸€å£å’¬ä¸‹ï¼Œå”‡é½¿ç•™é¦™ã€‚',
                        price: 35.00
                    },
                    // æ—¥é¤
                    {
                        id: 'menu-jp-1',
                        imageSrc: 'https://via.placeholder.com/300x200?text=å¯¿å¸æ‹¼ç›˜',
                        title: 'å¯¿å¸æ‹¼ç›˜',
                        description: 'æ–°é²œé±¼ç”Ÿæ­é…ç²¾è‡´ç±³é¥­ï¼Œå£å‘³ä¸°å¯Œï¼Œæ˜¯æ—¥æœ¬æ–™ç†çš„ä»£è¡¨ã€‚',
                        price: 138.00
                    },
                    {
                        id: 'menu-jp-2',
                        imageSrc: 'https://via.placeholder.com/300x200?text=è±šéª¨æ‹‰é¢',
                        title: 'è±šéª¨æ‹‰é¢',
                        description: 'æµ“éƒè±šéª¨æ±¤åº•ï¼Œæ­é…åŠ²é“æ‹‰é¢ã€å‰çƒ§å’Œæºå¿ƒè›‹ï¼Œæ»¡è¶³å‘³è•¾ã€‚',
                        price: 75.00
                    },
                    {
                        id: 'menu-jp-3',
                        imageSrc: 'https://via.placeholder.com/300x200?text=æ—¥å¼å¤©å¦‡ç½—',
                        title: 'æ—¥å¼å¤©å¦‡ç½—',
                        description: 'æ–°é²œè™¾ä»ä¸è”¬èœè£¹ä¸Šè–„æµ†ï¼Œç‚¸è‡³é‡‘é»„é…¥è„†ï¼Œå£æ„Ÿè½»ç›ˆã€‚',
                        price: 98.00
                    },
                    {
                        id: 'menu-jp-4',
                        imageSrc: 'https://via.placeholder.com/300x200?text=ç« é±¼å°ä¸¸å­',
                        title: 'ç« é±¼å°ä¸¸å­',
                        description: 'å¤–ç„¦é‡Œå«©ï¼ŒQå¼¹ç« é±¼å—ï¼Œæ·‹ä¸Šç‰¹åˆ¶é…±æ±å’Œæœ¨é±¼èŠ±ã€‚',
                        price: 30.00
                    },
                    // éŸ©é¤
                    {
                        id: 'menu-kr-1',
                        imageSrc: 'https://via.placeholder.com/300x200?text=éŸ©å¼æ‹Œé¥­',
                        title: 'éŸ©å¼æ‹Œé¥­',
                        description: 'äº”å½©è”¬èœã€è‚‰ç±»ä¸ç±³é¥­æ‹Œå…¥ç‰¹åˆ¶è¾£é…±ï¼Œè¥å…»å‡è¡¡ã€‚',
                        price: 65.00
                    },
                    {
                        id: 'menu-kr-2',
                        imageSrc: 'https://via.placeholder.com/300x200?text=éƒ¨é˜Ÿé”…',
                        title: 'éŸ©å¼éƒ¨é˜Ÿé”…',
                        description: 'ä¸°ç››çš„é£Ÿæï¼Œæµ“éƒçš„æ±¤åº•ï¼Œæ³¡èœã€ç«è…¿ã€èŠå£«çš„å®Œç¾èåˆã€‚',
                        price: 118.00
                    },
                    {
                        id: 'menu-kr-3',
                        imageSrc: 'https://via.placeholder.com/300x200?text=éŸ©å¼çƒ¤è‚‰',
                        title: 'éŸ©å¼çƒ¤è‚‰',
                        description: 'ç§˜åˆ¶é…±æ–™è…Œåˆ¶è‚‰ç‰‡ï¼Œæ­é…ç”Ÿèœã€æ³¡èœï¼Œæ„Ÿå—éŸ©å¼é£å‘³ã€‚',
                        price: 158.00
                    },
                    {
                        id: 'menu-kr-4',
                        imageSrc: 'https://via.placeholder.com/300x200?text=è¾£ç‚’å¹´ç³•',
                        title: 'éŸ©å¼è¾£ç‚’å¹´ç³•',
                        description: 'Qå¼¹å¹´ç³•ä¸é±¼é¥¼åœ¨ç”œè¾£é…±æ±ä¸­ç¿»ç‚’ï¼Œè¡—å¤´ç¾é£Ÿçš„ç»å…¸ã€‚',
                        price: 55.00
                    }
                ];
                menuItems = loadFromLocalStorage('myMenu', defaultMenuItems);
                saveMenu(); // ç¡®ä¿é»˜è®¤æ•°æ®ä¹Ÿè¢«ä¿å­˜ä¸€æ¬¡
            }

            function saveMenu() {
                saveToLocalStorage('myMenu', menuItems);
            }

            function renderMenu() {
                menuGrid.innerHTML = ''; // æ¸…ç©ºç°æœ‰å†…å®¹

                menuItems.forEach(item => {
                    const menuItemElement = document.createElement('div');
                    menuItemElement.classList.add('menu-item');
                    menuItemElement.dataset.id = item.id;

                    menuItemElement.innerHTML = `
                        <img src="${item.imageSrc}" alt="${item.title}">
                        <h3 contenteditable="false">${item.title}</h3>
                        <p contenteditable="false">${item.description}</p>
                        <span class="price" contenteditable="false">Â¥ ${item.price.toFixed(2)}</span>
                        <div class="item-actions menu-actions">
                            <label for="menu-file-input-${item.id}" class="upload-label" style="display: none;">æ›´æ¢å›¾ç‰‡</label>
                            <input type="file" id="menu-file-input-${item.id}" accept="image/*" style="display: none;">
                            <button class="btn edit-menu-btn">ç¼–è¾‘</button>
                            <button class="btn delete-menu-btn">åˆ é™¤</button>
                        </div>
                        <button class="btn select-menu-btn">ç‚¹èœ</button>
                    `;
                    menuGrid.appendChild(menuItemElement);
                });
            }

            function toggleMenuEditMode(itemElement, isEditMode) {
                const itemId = itemElement.dataset.id;
                const itemData = menuItems.find(item => item.id === itemId);

                const titleElement = itemElement.querySelector('h3');
                const descriptionElement = itemElement.querySelector('p');
                const priceElement = itemElement.querySelector('.price');
                const editSaveBtn = itemElement.querySelector('.edit-menu-btn, .save-menu-btn');
                const uploadLabel = itemElement.querySelector('.upload-label');
                const selectMenuBtn = itemElement.querySelector('.select-menu-btn');


                if (!itemData) return;

                if (isEditMode) {
                    itemElement.classList.add('editing');
                    titleElement.setAttribute('contenteditable', 'true');
                    descriptionElement.setAttribute('contenteditable', 'true');
                    priceElement.setAttribute('contenteditable', 'true');
                    titleElement.focus();

                    editSaveBtn.textContent = 'ä¿å­˜';
                    editSaveBtn.classList.remove('edit-menu-btn');
                    editSaveBtn.classList.add('save-menu-btn');
                    uploadLabel.style.display = 'inline-block';
                    selectMenuBtn.style.display = 'none'; // ç¼–è¾‘æ—¶éšè—ç‚¹èœæŒ‰é’®

                } else {
                    itemElement.classList.remove('editing');
                    titleElement.removeAttribute('contenteditable');
                    descriptionElement.removeAttribute('contenteditable');
                    priceElement.removeAttribute('contenteditable');

                    itemData.title = titleElement.textContent.trim();
                    itemData.description = descriptionElement.textContent.trim();
                    // å°è¯•è§£æä»·æ ¼ï¼Œå¦‚æœæ— æ•ˆåˆ™ä¿ç•™åŸä»·
                    const newPrice = parseFloat(priceElement.textContent.replace(/[^\d.]/g, '')); // ç§»é™¤æ‰€æœ‰éæ•°å­—å’Œå°æ•°ç‚¹çš„å­—ç¬¦
                    if (!isNaN(newPrice) && newPrice >= 0) { // ç¡®ä¿æ˜¯æœ‰æ•ˆæ•°å­—ä¸”ä¸ä¸ºè´Ÿ
                        itemData.price = newPrice;
                    } else {
                        alert('ä»·æ ¼è¾“å…¥æ— æ•ˆï¼Œå·²æ¢å¤åŸä»·ã€‚è¯·ç¡®ä¿è¾“å…¥çš„æ˜¯æ•°å­—ã€‚');
                    }
                    priceElement.textContent = `Â¥ ${itemData.price.toFixed(2)}`; // å¼ºåˆ¶æ›´æ–°æ˜¾ç¤ºä¸ºå›ºå®šæ ¼å¼

                    saveMenu();
                    renderMenu(); // é‡æ–°æ¸²æŸ“é¡µé¢ä»¥åæ˜ æ›´æ”¹ (ä»·æ ¼ã€å›¾ç‰‡)
                }
            }

            // ========================= å¿ƒæ„¿æ¸…å•ç›¸å…³å‡½æ•° =========================
            function loadWishlist() {
                wishlistItems = loadFromLocalStorage('myWishlist', [
                    {
                        id: 'wish-1',
                        imageSrc: 'https://via.placeholder.com/300x200?text=æ™ºèƒ½æ‰‹è¡¨',
                        title: 'ä¸€æ¬¾æ™ºèƒ½æ‰‹è¡¨',
                        description: 'å¸Œæœ›æ‹¥æœ‰ä¸€æ¬¾èƒ½å¤Ÿè¿½è¸ªå¥åº·æ•°æ®ã€æ–¹ä¾¿ç”Ÿæ´»ä¸è¿åŠ¨çš„æ™ºèƒ½ç©¿æˆ´è®¾å¤‡ã€‚',
                        status: 'pending'
                    },
                    {
                        id: 'wish-2',
                        imageSrc: 'https://via.placeholder.com/300x200?text=æµªæ¼«æ—…è¡Œ',
                        title: 'ä¸€æ¬¡æµªæ¼«æ—…è¡Œ',
                        description: 'å¸Œæœ›å’Œä½ ä¸€èµ·å»ä¸€ä¸ªç¾ä¸½çš„åœ°æ–¹ï¼Œç•™ä¸‹å±äºæˆ‘ä»¬çš„ç¾å¥½å›å¿†ã€‚',
                        status: 'pending'
                    },
                    {
                        id: 'wish-3',
                        imageSrc: 'https://via.placeholder.com/300x200?text=ä¸€æœ¬å¥½ä¹¦',
                        title: 'ä¸€æœ¬æ·±åº¦ä¸å¹¿åº¦å…¼å…·çš„æ–‡å­¦ä½œå“ï¼Œä¸°å¯Œç²¾ç¥ä¸–ç•Œã€‚',
                        status: 'fulfilled'
                    }
                ]);
                saveWishlist(); // ç¡®ä¿é»˜è®¤æ•°æ®ä¹Ÿè¢«ä¿å­˜ä¸€æ¬¡
            }

            function saveWishlist() {
                saveToLocalStorage('myWishlist', wishlistItems);
            }

            function renderWishlist() {
                wishlistGrid.innerHTML = ''; // æ¸…ç©ºç°æœ‰å†…å®¹

                wishlistItems.forEach(item => {
                    const wishlistItemElement = document.createElement('div');
                    wishlistItemElement.classList.add('wishlist-item');
                    wishlistItemElement.dataset.id = item.id;

                    const statusText = item.status === 'pending' ? 'æœªè¾¾æˆ' : 'å·²è¾¾æˆ';

                    wishlistItemElement.innerHTML = `
                        <img src="${item.imageSrc}" alt="${item.title}">
                        <h3 contenteditable="false">${item.title}</h3>
                        <p contenteditable="false">${item.description}</p>
                        <p class="status ${item.status}" data-status="${item.status}">${statusText}</p>
                        <div class="item-actions">
                            <label for="wish-file-input-${item.id}" class="upload-label" style="display: none;">æ›´æ¢å›¾ç‰‡</label>
                            <input type="file" id="wish-file-input-${item.id}" accept="image/*" style="display: none;">
                            <button class="btn edit-btn">ç¼–è¾‘</button>
                            <button class="btn delete-btn">åˆ é™¤</button>
                        </div>
                    `;
                    wishlistGrid.appendChild(wishlistItemElement);
                });
            }

            function toggleWishlistEditMode(itemElement, isEditMode) {
                const itemId = itemElement.dataset.id;
                const itemData = wishlistItems.find(item => item.id === itemId);

                const titleElement = itemElement.querySelector('h3');
                const descriptionElement = itemElement.querySelector('p:not(.status)');
                const statusElement = itemElement.querySelector('.status');
                const editSaveBtn = itemElement.querySelector('.edit-btn, .save-btn');
                const uploadLabel = itemElement.querySelector('.upload-label');

                if (!itemData) return;

                if (isEditMode) {
                    itemElement.classList.add('editing');
                    titleElement.setAttribute('contenteditable', 'true');
                    descriptionElement.setAttribute('contenteditable', 'true');
                    titleElement.focus();

                    statusElement.innerHTML = `
                        <select class="status-select">
                            <option value="pending" ${itemData.status === 'pending' ? 'selected' : ''}>æœªè¾¾æˆ</option>
                            <option value="fulfilled" ${itemData.status === 'fulfilled' ? 'selected' : ''}>å·²è¾¾æˆ</option>
                        </select>
                    `;

                    editSaveBtn.textContent = 'ä¿å­˜';
                    editSaveBtn.classList.remove('edit-btn');
                    editSaveBtn.classList.add('save-btn');
                    uploadLabel.style.display = 'inline-block';
                } else {
                    itemElement.classList.remove('editing');
                    titleElement.removeAttribute('contenteditable');
                    descriptionElement.removeAttribute('contenteditable');

                    itemData.title = titleElement.textContent.trim();
                    itemData.description = descriptionElement.textContent.trim();

                    const statusSelect = itemElement.querySelector('.status-select');
                    if (statusSelect) {
                        itemData.status = statusSelect.value;
                    }

                    saveWishlist();
                    renderWishlist(); // é‡æ–°æ¸²æŸ“é¡µé¢ä»¥åæ˜ æ›´æ”¹
                }
            }

            // ========================= è®¢å•ç®¡ç†ç›¸å…³å‡½æ•° =========================
            function loadSelectedOrder() {
                selectedOrder = loadFromLocalStorage('mySelectedOrder', []);
            }

            function saveSelectedOrder() {
                saveToLocalStorage('mySelectedOrder', selectedOrder);
            }

            function addToOrder(menuItemId) {
                // ä»å½“å‰èœå•æ•°æ®ä¸­æŸ¥æ‰¾èœå“ï¼Œè€Œä¸æ˜¯å›ºå®šæ•°æ®
                const menuItem = menuItems.find(item => item.id === menuItemId);
                if (!menuItem) return;

                const existingOrderItem = selectedOrder.find(item => item.id === menuItemId);
                if (existingOrderItem) {
                    existingOrderItem.quantity++;
                } else {
                    selectedOrder.push({
                        id: menuItem.id,
                        title: menuItem.title,
                        price: menuItem.price,
                        quantity: 1
                    });
                }
                saveSelectedOrder();
                renderOrderSummary();
            }

            // å¢åŠ èœå“æ•°é‡
            function increaseOrderItemQuantity(orderItemId) {
                const orderItem = selectedOrder.find(item => item.id === orderItemId);
                if (orderItem) {
                    orderItem.quantity++;
                    saveSelectedOrder();
                    renderOrderSummary();
                }
            }

            // å‡å°‘èœå“æ•°é‡
            function decreaseOrderItemQuantity(orderItemId) {
                const orderItem = selectedOrder.find(item => item.id === orderItemId);
                if (orderItem) {
                    orderItem.quantity--;
                    if (orderItem.quantity <= 0) {
                        // å¦‚æœæ•°é‡å°äºç­‰äº0ï¼Œåˆ™ç§»é™¤è¯¥èœå“
                        selectedOrder = selectedOrder.filter(item => item.id !== orderItemId);
                    }
                    saveSelectedOrder();
                    renderOrderSummary();
                }
            }

            function renderOrderSummary() {
                orderSummaryList.innerHTML = '';
                let total = 0;

                if (selectedOrder.length === 0) {
                    orderSummaryList.innerHTML = '<p>æš‚æ— å·²ç‚¹èœå“ã€‚</p>';
                } else {
                    selectedOrder.forEach(orderItem => {
                        const listItem = document.createElement('div');
                        listItem.classList.add('order-list-item');
                        listItem.innerHTML = `
                            <div class="order-item-details">
                                <span>${orderItem.title}</span>
                                <div class="qty-controls">
                                    <button class="btn btn-qty decrease-qty-btn" data-id="${orderItem.id}">-</button>
                                    <input type="number" class="item-qty-input" value="${orderItem.quantity}" min="0" data-id="${orderItem.id}">
                                    <button class="btn btn-qty increase-qty-btn" data-id="${orderItem.id}">+</button>
                                </div>
                            </div>
                            <div class="order-item-price-actions">
                                <span>Â¥ ${(orderItem.price * orderItem.quantity).toFixed(2)}</span>
                                <button class="btn btn-small remove-order-item-btn" data-id="${orderItem.id}">ç§»é™¤</button>
                            </div>
                        `;
                        orderSummaryList.appendChild(listItem);
                        total += orderItem.price * orderItem.quantity;
                    });
                }
                orderTotalSpan.textContent = `Â¥ ${total.toFixed(2)}`;
            }

            function clearOrder() {
                if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å·²ç‚¹èœå“å—ï¼Ÿ')) {
                    selectedOrder = [];
                    saveSelectedOrder();
                    renderOrderSummary();
                    alert('è®¢å•å·²æ¸…ç©ºï¼');
                }
            }

            function confirmOrder() {
                if (selectedOrder.length === 0) {
                    alert('æ‚¨çš„è®¢å•ä¸ºç©ºï¼Œè¯·å…ˆç‚¹èœï¼');
                    return;
                }

                let orderDetailsText = "";
                let totalAmount = 0;
                const currentDate = new Date().toLocaleString();

                orderDetailsText += `è®¢å•æ—¶é—´: ${currentDate}\n`;
                orderDetailsText += `\n--- è®¢å•è¯¦æƒ… ---\n`;

                selectedOrder.forEach(item => {
                    const subtotal = item.price * item.quantity;
                    orderDetailsText += `${item.title} x ${item.quantity} (Â¥ ${item.price.toFixed(2)}/ä»½) = Â¥ ${subtotal.toFixed(2)}\n`;
                    totalAmount += subtotal;
                });

                orderDetailsText += `\næ€»è®¡ï¼šÂ¥ ${totalAmount.toFixed(2)}\n`;
                orderDetailsText += `\nè¿™æ˜¯ä¸€ä¸ªæ¥è‡ªèƒ–æ¬£æ¬£ç˜¦åª›åª›å®¶åº­å‘µæŠ¤ç½‘çš„æ–°è®¢å•é€šçŸ¥ã€‚\nè¯·åŠæ—¶å¤„ç†ï¼`;

                // --- é‚®ä»¶é€šçŸ¥éƒ¨åˆ†ï¼ˆä½¿ç”¨ mailto: åè®®ï¼‰ ---
                // ä½¿ç”¨ encodeURIComponent ç¼–ç ï¼Œä»¥ç¡®ä¿ç‰¹æ®Šå­—ç¬¦åœ¨URLä¸­æ­£ç¡®æ˜¾ç¤º
                const recipientEmail = "xinluo1231998@gmail.com"; // <-- æ‚¨çš„é‚®ç®±åœ°å€
                const subject = encodeURIComponent(`èƒ–æ¬£æ¬£ç˜¦åª›åª›å®¶åº­å‘µæŠ¤ç½‘ - æ–°è®¢å•é€šçŸ¥ (${currentDate})`);
                const body = encodeURIComponent(orderDetailsText);

                const mailtoLink = `mailto:${recipientEmail}?subject=${subject}&body=${body}`;

                // æç¤ºç”¨æˆ·å¹¶å°è¯•æ‰“å¼€é‚®ä»¶å®¢æˆ·ç«¯
                alert("è®¢å•å·²æˆåŠŸæäº¤ï¼\n\næ¥ä¸‹æ¥å°†å°è¯•æ‰“å¼€æ‚¨çš„é‚®ä»¶å®¢æˆ·ç«¯å‘é€é€šçŸ¥ã€‚\nè¯·åœ¨å¼¹å‡ºçš„é‚®ä»¶çª—å£ä¸­ç‚¹å‡»â€œå‘é€â€æŒ‰é’®ä»¥å®Œæˆé€šçŸ¥ã€‚\n\nå®Œæ•´çš„è®¢å•ä¿¡æ¯å·²åœ¨æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ä¸­æ‰“å°ã€‚");

                // åœ¨æ–°çª—å£æˆ–æ ‡ç­¾é¡µä¸­æ‰“å¼€ mailto é“¾æ¥ï¼Œé¿å…ç›´æ¥è·³è½¬å½“å‰é¡µé¢
                window.open(mailtoLink, '_blank');
                // --- é‚®ä»¶é€šçŸ¥éƒ¨åˆ†ç»“æŸ ---


                // !! åå°æ¥æ”¶ä¿¡æ¯æ¨¡æ‹Ÿ (æ‰“å°åˆ°æ§åˆ¶å°) !!
                // æ­¤éƒ¨åˆ†ä¿æŒä¸å˜ï¼Œä»¥ä¾¿æ‚¨ä»ç„¶å¯ä»¥åœ¨æ§åˆ¶å°æŸ¥çœ‹å®Œæ•´çš„ç»“æ„åŒ–æ•°æ®
                console.log('--- æ¨¡æ‹Ÿè®¢å•æ•°æ®å‘é€åˆ°åå° ---');
                console.log('è®¢å•æ•°æ®:', {
                    timestamp: currentDate,
                    items: selectedOrder.map(item => ({
                        id: item.id,
                        title: item.title,
                        price: item.price,
                        quantity: item.quantity,
                        subtotal: (item.price * item.quantity).toFixed(2)
                    })),
                    total: totalAmount.toFixed(2)
                });
                console.log('æç¤º: è¿™éƒ¨åˆ†æ•°æ®ç°åœ¨æ‰“å°åœ¨æµè§ˆå™¨æ§åˆ¶å°ã€‚è¦å®ç°çœŸæ­£çš„åå°æ¥æ”¶å’Œè‡ªåŠ¨é‚®ä»¶é€šçŸ¥ï¼Œéœ€è¦åç«¯æœåŠ¡å’ŒAPIã€‚');
                console.log('----------------------------');

                // è®¢å•ç¡®è®¤åæ¸…ç©ºè®¢å•
                selectedOrder = [];
                saveSelectedOrder();
                renderOrderSummary();
            }

            // ========================= å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½å‡½æ•° =========================

            // å¯¼å‡ºæ•°æ®é€šç”¨å‡½æ•°
            function exportData(data, filename) {
                const jsonData = JSON.stringify(data, null, 2); // æ ¼å¼åŒ–JSONï¼Œæ–¹ä¾¿é˜…è¯»
                const blob = new Blob([jsonData], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                alert(`æ•°æ®å·²æˆåŠŸå¯¼å‡ºä¸º ${filename}`);
            }

            // å¯¼å…¥æ•°æ®é€šç”¨å‡½æ•°
            function importData(event, type) {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedArray = JSON.parse(e.target.result);

                        // ç®€å•çš„éªŒè¯
                        if (!Array.isArray(importedArray)) {
                            throw new Error('å¯¼å…¥çš„æ–‡ä»¶ä¸æ˜¯æœ‰æ•ˆçš„æ•°ç»„æ ¼å¼ã€‚');
                        }

                        let isValid = true;
                        let message = '';

                        if (type === 'wishlist') {
                            isValid = importedArray.every(item =>
                                typeof item.id === 'string' &&
                                typeof item.imageSrc === 'string' &&
                                typeof item.title === 'string' &&
                                typeof item.description === 'string' &&
                                ['pending', 'fulfilled'].includes(item.status)
                            );
                            message = 'å¿ƒæ„¿æ¸…å•';
                        } else if (type === 'order') {
                            isValid = importedArray.every(item =>
                                typeof item.id === 'string' &&
                                typeof item.title === 'string' &&
                                typeof item.price === 'number' &&
                                typeof item.quantity === 'number' &&
                                item.quantity >= 0
                            );
                            message = 'è®¢å•';
                        } else if (type === 'menu') {
                            isValid = importedArray.every(item =>
                                typeof item.id === 'string' &&
                                typeof item.imageSrc === 'string' &&
                                typeof item.title === 'string' &&
                                typeof item.description === 'string' &&
                                typeof item.price === 'number' &&
                                item.price >= 0
                            );
                            message = 'èœå•';
                        }

                        if (!isValid) {
                            throw new Error(`å¯¼å…¥çš„${message}æ•°æ®ç»“æ„ä¸ç¬¦åˆé¢„æœŸï¼Œè¯·æ£€æŸ¥JSONæ–‡ä»¶å†…å®¹ã€‚`);
                        }

                        if (confirm(`ç¡®å®šè¦å¯¼å…¥${message}å—ï¼Ÿè¿™ä¼šè¦†ç›–å½“å‰æ‰€æœ‰${message}æ•°æ®ã€‚`)) {
                            if (type === 'wishlist') {
                                wishlistItems = importedArray;
                                saveWishlist();
                                renderWishlist();
                            } else if (type === 'order') {
                                selectedOrder = importedArray;
                                saveSelectedOrder();
                                renderOrderSummary();
                            } else if (type === 'menu') {
                                menuItems = importedArray;
                                saveMenu();
                                renderMenu();
                            }
                            alert(`${message}å·²æˆåŠŸå¯¼å…¥ï¼`);
                        }
                    } catch (error) {
                        console.error('å¯¼å…¥æ•°æ®å¤±è´¥:', error);
                        alert('å¯¼å…¥æ•°æ®å¤±è´¥: ' + error.message + '\nè¯·ç¡®ä¿å¯¼å…¥çš„æ˜¯æœ‰æ•ˆçš„JSONæ–‡ä»¶ä¸”æ•°æ®ç»“æ„æ­£ç¡®ã€‚');
                    }
                };
                reader.readAsText(file);
                // æ¸…ç©ºæ–‡ä»¶è¾“å…¥æ¡†ï¼Œä»¥ä¾¿å†æ¬¡é€‰æ‹©ç›¸åŒæ–‡ä»¶
                event.target.value = '';
            }


            // ========================= äº‹ä»¶ç›‘å¬å™¨ =========================
            // èœå•â€œæ·»åŠ æ–°èœå“â€æŒ‰é’®
            addMenuItemBtn.addEventListener('click', () => {
                const newId = `menu-${Date.now()}`;
                const newItem = {
                    id: newId,
                    imageSrc: 'https://via.placeholder.com/300x200?text=æ–°èœå“å›¾ç‰‡',
                    title: 'æ–°èœå“åç§°',
                    description: 'æ–°èœå“æè¿°...',
                    price: 0.00
                };
                menuItems.unshift(newItem); // æ·»åŠ åˆ°æ•°ç»„å¼€å¤´
                saveMenu();
                renderMenu(); // é‡æ–°æ¸²æŸ“æ•´ä¸ªåˆ—è¡¨

                const newItemElement = menuGrid.querySelector(`[data-id="${newId}"]`);
                if (newItemElement) {
                    toggleMenuEditMode(newItemElement, true);
                    newItemElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });

            // èœå•é¡¹äº‹ä»¶å§”æ‰˜ï¼ˆç¼–è¾‘ã€åˆ é™¤ã€å›¾ç‰‡ä¸Šä¼ ã€ç‚¹èœï¼‰
            menuGrid.addEventListener('click', (event) => {
                const target = event.target;
                const menuItemElement = target.closest('.menu-item');

                if (!menuItemElement) return;

                const itemId = menuItemElement.dataset.id;

                if (target.classList.contains('delete-menu-btn')) {
                    if (confirm('ç¡®å®šè¦åˆ é™¤æ­¤èœå“å—ï¼Ÿ')) {
                        menuItems = menuItems.filter(item => item.id !== itemId);
                        saveMenu();
                        renderMenu();
                    }
                } else if (target.classList.contains('edit-menu-btn')) {
                    toggleMenuEditMode(menuItemElement, true);
                } else if (target.classList.contains('save-menu-btn')) {
                    toggleMenuEditMode(menuItemElement, false);
                } else if (target.classList.contains('upload-label')) {
                    const fileInput = menuItemElement.querySelector(`#menu-file-input-${itemId}`);
                    if (fileInput) {
                        fileInput.click();
                    }
                } else if (target.classList.contains('select-menu-btn')) {
                    addToOrder(itemId);
                }
            });

            // èœå•é¡¹å›¾ç‰‡ä¸Šä¼ 
            menuGrid.addEventListener('change', (event) => {
                const target = event.target;
                if (target.type === 'file' && target.accept === 'image/*') {
                    const menuItemElement = target.closest('.menu-item');
                    const itemId = menuItemElement.dataset.id;
                    const itemData = menuItems.find(item => item.id === itemId);

                    if (itemData && target.files && target.files[0]) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            itemData.imageSrc = e.target.result;
                            saveMenu();
                            menuItemElement.querySelector('img').src = e.target.result;
                        };
                        reader.readAsDataURL(target.files[0]);
                    }
                }
            });


            // å¿ƒæ„¿æ¸…å•äº‹ä»¶å§”æ‰˜
            wishlistGrid.addEventListener('click', (event) => {
                const target = event.target;
                const wishlistItem = target.closest('.wishlist-item');

                if (!wishlistItem) return;

                const itemId = wishlistItem.dataset.id;

                if (target.classList.contains('delete-btn')) {
                    if (confirm('ç¡®å®šè¦åˆ é™¤æ­¤å¿ƒæ„¿å—ï¼Ÿ')) {
                        wishlistItems = wishlistItems.filter(item => item.id !== itemId);
                        saveWishlist();
                        renderWishlist();
                    }
                } else if (target.classList.contains('edit-btn')) {
                    toggleWishlistEditMode(wishlistItem, true);
                } else if (target.classList.contains('save-btn')) {
                    toggleWishlistEditMode(wishlistItem, false);
                } else if (target.classList.contains('upload-label')) {
                    const fileInput = wishlistItem.querySelector(`#wish-file-input-${itemId}`);
                    if (fileInput) {
                        fileInput.click();
                    }
                }
            });

            // å¿ƒæ„¿æ¸…å•æ–‡ä»¶è¾“å…¥æ¡†çš„ change äº‹ä»¶
            wishlistGrid.addEventListener('change', (event) => {
                const target = event.target;
                if (target.type === 'file' && target.accept === 'image/*') {
                    const wishlistItemElement = target.closest('.wishlist-item');
                    const itemId = wishlistItemElement.dataset.id;
                    const itemData = wishlistItems.find(item => item.id === itemId);

                    if (itemData && target.files && target.files[0]) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            itemData.imageSrc = e.target.result;
                            saveWishlist();
                            wishlistItemElement.querySelector('img').src = e.target.result;
                        };
                        reader.readAsDataURL(target.files[0]);
                    }
                }
            });

            // æ·»åŠ æ–°å¿ƒæ„¿æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            addWishBtn.addEventListener('click', () => {
                const newId = `wish-${Date.now()}`;
                const newItem = {
                    id: newId,
                    imageSrc: 'https://via.placeholder.com/300x200?text=ç‚¹å‡»æ›´æ¢å›¾ç‰‡',
                    title: 'æ–°å¿ƒæ„¿æ ‡é¢˜',
                    description: 'è¯·åœ¨æ­¤è¾“å…¥æ‚¨çš„å¿ƒæ„¿æè¿°...',
                    status: 'pending'
                };
                wishlistItems.unshift(newItem);
                saveWishlist();
                renderWishlist();

                const newItemElement = wishlistGrid.querySelector(`[data-id="${newId}"]`);
                if (newItemElement) {
                    toggleWishlistEditMode(newItemElement, true);
                    newItemElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });


            // è®¢å•â€œç§»é™¤â€ã€â€œå¢åŠ æ•°é‡â€å’Œâ€œå‡å°‘æ•°é‡â€æŒ‰é’®äº‹ä»¶å§”æ‰˜
            orderSummaryList.addEventListener('click', (event) => {
                const target = event.target;
                const orderItemId = target.dataset.id;

                if (target.classList.contains('remove-order-item-btn')) {
                    if (confirm('ç¡®å®šè¦ç§»é™¤æ­¤èœå“å—ï¼Ÿ')) {
                        selectedOrder = selectedOrder.filter(item => item.id !== orderItemId);
                        saveSelectedOrder();
                        renderOrderSummary();
                    }
                } else if (target.classList.contains('increase-qty-btn')) {
                    increaseOrderItemQuantity(orderItemId);
                } else if (target.classList.contains('decrease-qty-btn')) {
                    decreaseOrderItemQuantity(orderItemId);
                }
            });

            // è®¢å•æ•°é‡è¾“å…¥æ¡†çš„ change äº‹ä»¶ (å¤±å»ç„¦ç‚¹æˆ–æŒ‰å›è½¦æ—¶è§¦å‘)
            orderSummaryList.addEventListener('change', (event) => {
                const target = event.target;
                if (target.classList.contains('item-qty-input')) {
                    const orderItemId = target.dataset.id;
                    let newQuantity = parseInt(target.value, 10);

                    if (isNaN(newQuantity) || newQuantity < 0) {
                        // Revert to previous valid quantity if input is invalid
                        const currentItem = selectedOrder.find(item => item.id === orderItemId);
                        target.value = currentItem ? currentItem.quantity : 1; // Default to 1 if not found or invalid
                        alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°é‡ (éè´Ÿæ•´æ•°)ã€‚');
                        return;
                    }

                    // Find the item and update its quantity
                    const orderItem = selectedOrder.find(item => item.id === orderItemId);
                    if (orderItem) {
                        if (newQuantity === 0) {
                            // If quantity becomes 0, remove the item
                            selectedOrder = selectedOrder.filter(item => item.id !== orderItemId);
                        } else {
                            orderItem.quantity = newQuantity;
                        }
                        saveSelectedOrder();
                        renderOrderSummary();
                    }
                }
            });


            // è®¢å•â€œæ¸…ç©ºâ€æŒ‰é’®äº‹ä»¶
            clearOrderBtn.addEventListener('click', clearOrder);

            // è®¢å•â€œç¡®è®¤è®¢å•â€æŒ‰é’®äº‹ä»¶
            confirmOrderBtn.addEventListener('click', confirmOrder);

            // å¯¼å…¥/å¯¼å‡ºäº‹ä»¶ç›‘å¬
            exportMenuBtn.addEventListener('click', () => exportData(menuItems, 'èƒ–æ¬£æ¬£ç˜¦åª›åª›_èœå•.json'));
            importMenuFile.addEventListener('change', (e) => importData(e, 'menu'));

            exportOrderBtn.addEventListener('click', () => exportData(selectedOrder, 'èƒ–æ¬£æ¬£ç˜¦åª›åª›_æˆ‘çš„è®¢å•.json'));
            importOrderFile.addEventListener('change', (e) => importData(e, 'order'));

            exportWishlistBtn.addEventListener('click', () => exportData(wishlistItems, 'èƒ–æ¬£æ¬£ç˜¦åª›åª›_å¿ƒæ„¿æ¸…å•.json'));
            importWishlistFile.addEventListener('change', (e) => importData(e, 'wishlist'));


            // ========================= é¡µé¢åˆå§‹åŒ– =========================
            loadMenu();
            renderMenu();
            loadWishlist();
            renderWishlist();
            loadSelectedOrder();
            renderOrderSummary();
        });
    </script>
</body>
</html>

							<script>
                            	
							</script>
                        </body>
                        </html>
                    
